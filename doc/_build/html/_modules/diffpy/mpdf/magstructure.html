<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>diffpy.mpdf.magstructure &mdash; diffpy.mpdf 0.0.0 documentation</title>
    
    <link rel="stylesheet" href="../../../_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../../',
        VERSION:     '0.0.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../../_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="top" title="diffpy.mpdf 0.0.0 documentation" href="../../../index.html" />
    <link rel="up" title="Module code" href="../../index.html" />
   
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head>
  <body role="document">  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <h1>Source code for diffpy.mpdf.magstructure</h1><div class="highlight"><pre>
<span></span><span class="ch">#!/usr/bin/env python</span>
<span class="c1">##############################################################################</span>
<span class="c1">#</span>
<span class="c1"># diffpy.mpdf         by Billinge Group</span>
<span class="c1">#                     Simon J. L. Billinge sb2896@columbia.edu</span>
<span class="c1">#                     (c) 2016 trustees of Columbia University in the City of</span>
<span class="c1">#                           New York.</span>
<span class="c1">#                      All rights reserved</span>
<span class="c1">#</span>
<span class="c1"># File coded by:    Benjamin Frandsen</span>
<span class="c1">#</span>
<span class="c1"># See AUTHORS.txt for a list of people who contributed.</span>
<span class="c1"># See LICENSE.txt for license information.</span>
<span class="c1">#</span>
<span class="c1">##############################################################################</span>


<span class="sd">&quot;&quot;&quot;functions and classes to create magnetic structures for mPDF calculations.&quot;&quot;&quot;</span>


<span class="kn">import</span> <span class="nn">copy</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">diffpy.srreal.bondcalculator</span> <span class="kn">import</span> <span class="n">BondCalculator</span>
<span class="kn">from</span> <span class="nn">diffpy.mpdf.mpdfcalculator</span> <span class="kn">import</span> <span class="n">jCalc</span>

<div class="viewcode-block" id="generateAtomsXYZ"><a class="viewcode-back" href="../../../source/diffpy.mpdf.html#diffpy.mpdf.magstructure.generateAtomsXYZ">[docs]</a><span class="k">def</span> <span class="nf">generateAtomsXYZ</span><span class="p">(</span><span class="n">struc</span><span class="p">,</span> <span class="n">rmax</span><span class="o">=</span><span class="mf">30.0</span><span class="p">,</span> <span class="n">magIdxs</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">square</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Generate array of atomic Cartesian coordinates from a given structure.</span>

<span class="sd">    Args:</span>
<span class="sd">        struc (diffpy.Structure object): provides lattice parameters and unit</span>
<span class="sd">            cell of the desired structure</span>
<span class="sd">        rmax (float): largest distance from central atom that should be</span>
<span class="sd">            included</span>
<span class="sd">        magIdxs (python list): list of integers giving indices of magnetic</span>
<span class="sd">            atoms in the unit cell</span>
<span class="sd">        square (boolean): if not True, atoms within a given radius from the</span>
<span class="sd">            origin will be returned; if True, then the full grid will be</span>
<span class="sd">            returned rather than just a spherical selection.</span>

<span class="sd">    Returns:</span>
<span class="sd">        numpy array of triples giving the Cartesian coordinates of all the</span>
<span class="sd">            magnetic atoms. Atom closest to the origin placed first in array.</span>

<span class="sd">    Note: If square = True, this may have problems for structures that have</span>
<span class="sd">        a several distorted unit cell (i.e. highly non-orthorhombic).</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">square</span><span class="p">:</span>
        <span class="n">magAtoms</span> <span class="o">=</span> <span class="n">struc</span><span class="p">[</span><span class="n">magIdxs</span><span class="p">]</span>
        <span class="n">bc</span> <span class="o">=</span> <span class="n">BondCalculator</span><span class="p">(</span><span class="n">rmax</span><span class="o">=</span><span class="n">rmax</span><span class="o">+</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">struc</span><span class="o">.</span><span class="n">lattice</span><span class="o">.</span><span class="n">stdbase</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)))</span>
        <span class="n">bc</span><span class="o">.</span><span class="n">setPairMask</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;all&#39;</span><span class="p">,</span> <span class="bp">True</span><span class="p">,</span> <span class="n">others</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
        <span class="n">bc</span><span class="p">(</span><span class="n">magAtoms</span><span class="p">)</span>
        <span class="n">r0</span> <span class="o">=</span> <span class="n">struc</span><span class="o">.</span><span class="n">xyz_cartn</span><span class="p">[</span><span class="n">magIdxs</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>
        <span class="n">atoms</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">([</span><span class="n">r0</span><span class="p">,</span> <span class="n">r0</span><span class="o">+</span><span class="n">bc</span><span class="o">.</span><span class="n">directions</span><span class="p">[</span><span class="n">bc</span><span class="o">.</span><span class="n">sites0</span> <span class="o">==</span> <span class="mi">0</span><span class="p">]])</span>

    <span class="k">else</span><span class="p">:</span>
        <span class="c1">### generate the coordinates of each unit cell</span>
        <span class="n">lat</span> <span class="o">=</span> <span class="n">struc</span><span class="o">.</span><span class="n">lattice</span>
        <span class="n">unitcell</span> <span class="o">=</span> <span class="n">lat</span><span class="o">.</span><span class="n">stdbase</span>
        <span class="n">cellwithatoms</span> <span class="o">=</span> <span class="n">struc</span><span class="o">.</span><span class="n">xyz_cartn</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">magIdxs</span><span class="p">)]</span>
        <span class="n">dim1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">rmax</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">unitcell</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
        <span class="n">dim2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">rmax</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">unitcell</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
        <span class="n">dim3</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">rmax</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">unitcell</span><span class="p">[</span><span class="mi">2</span><span class="p">]))</span>
        <span class="n">ocoords</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mgrid</span><span class="p">[</span><span class="o">-</span><span class="n">dim1</span><span class="p">:</span><span class="n">dim1</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="n">dim2</span><span class="p">:</span><span class="n">dim2</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="n">dim3</span><span class="p">:</span><span class="n">dim3</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span><span class="o">.</span><span class="n">ravel</span><span class="p">()</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="mi">2</span><span class="o">*</span><span class="n">dim1</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">dim2</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">dim3</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span> <span class="mi">3</span><span class="p">)</span>
        <span class="n">latos</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">ocoords</span><span class="p">,</span> <span class="n">unitcell</span><span class="p">)</span>

        <span class="c1">### rearrange latos array so that [0, 0, 0] is the first one (for convenience)</span>
        <span class="n">latos</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">latos</span> <span class="o">==</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">))]</span> <span class="o">=</span> <span class="n">latos</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">latos</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>

        <span class="c1">### create list of all atomic positions</span>
        <span class="n">atoms</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">([</span><span class="nb">len</span><span class="p">(</span><span class="n">latos</span><span class="p">)</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span><span class="n">cellwithatoms</span><span class="p">),</span> <span class="mi">3</span><span class="p">])</span>
        <span class="n">index</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">lato</span> <span class="ow">in</span> <span class="n">latos</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">atompos</span> <span class="ow">in</span> <span class="n">cellwithatoms</span><span class="p">:</span>
                <span class="n">atoms</span><span class="p">[</span><span class="n">index</span><span class="p">]</span> <span class="o">=</span> <span class="n">lato</span> <span class="o">+</span> <span class="n">atompos</span>
                <span class="n">index</span> <span class="o">+=</span> <span class="mi">1</span>

    <span class="k">return</span> <span class="n">atoms</span></div>

<div class="viewcode-block" id="generateSpinsXYZ"><a class="viewcode-back" href="../../../source/diffpy.mpdf.html#diffpy.mpdf.magstructure.generateSpinsXYZ">[docs]</a><span class="k">def</span> <span class="nf">generateSpinsXYZ</span><span class="p">(</span><span class="n">struc</span><span class="p">,</span> <span class="n">atoms</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[]]),</span> <span class="n">kvecs</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]]),</span>
                     <span class="n">basisvecs</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]])):</span>
    <span class="sd">&quot;&quot;&quot;Generate array of 3-vectors representing the spins in a structure.</span>

<span class="sd">    Args:</span>
<span class="sd">        struc (diffpy.Structure object): provides lattice parameters and unit</span>
<span class="sd">            cell of the desired structure</span>
<span class="sd">        atoms (numpy array): list of atomic coordinates of all the magnetic</span>
<span class="sd">            atoms in the structure; e.g. generated by generateAtomsXYZ()</span>
<span class="sd">        kvecs (numpy array): list of three-vectors giving the propagation</span>
<span class="sd">            vector(s) of the magnetic structure</span>
<span class="sd">        basisvecs (numpy array): list of three-vectors describing the spin</span>
<span class="sd">            located at the spin origin.</span>

<span class="sd">    Returns:</span>
<span class="sd">        numpy array of triples giving the spin vectors of all the magnetic</span>
<span class="sd">            atoms, in the same order as the atoms array provided as input.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">lat</span> <span class="o">=</span> <span class="n">struc</span><span class="o">.</span><span class="n">lattice</span>
    <span class="n">rlat</span> <span class="o">=</span> <span class="n">lat</span><span class="o">.</span><span class="n">reciprocal</span><span class="p">()</span>
    <span class="p">(</span><span class="n">astar</span><span class="p">,</span> <span class="n">bstar</span><span class="p">,</span> <span class="n">cstar</span><span class="p">)</span> <span class="o">=</span> <span class="p">(</span><span class="n">rlat</span><span class="o">.</span><span class="n">cartesian</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)),</span> <span class="n">rlat</span><span class="o">.</span><span class="n">cartesian</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">)),</span>
                             <span class="n">rlat</span><span class="o">.</span><span class="n">cartesian</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)))</span>
    <span class="n">i</span> <span class="o">=</span> <span class="mi">1j</span>

    <span class="n">spins</span> <span class="o">=</span> <span class="mi">0</span><span class="o">*</span><span class="n">atoms</span>
    <span class="n">cspins</span> <span class="o">=</span> <span class="mi">0</span><span class="o">*</span><span class="n">atoms</span> <span class="o">+</span> <span class="mi">0j</span><span class="o">*</span><span class="n">atoms</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">kvecs</span><span class="p">)</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">kvecs</span> <span class="o">=</span> <span class="p">[</span><span class="n">kvecs</span><span class="p">]</span>        
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">basisvecs</span><span class="p">)</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">basisvecs</span> <span class="o">=</span> <span class="p">[</span><span class="n">basisvecs</span><span class="p">]</span>        
    <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">kvec</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">kvecs</span><span class="p">):</span>
        <span class="n">kcart</span> <span class="o">=</span> <span class="n">kvec</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">astar</span> <span class="o">+</span> <span class="n">kvec</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">bstar</span> <span class="o">+</span> <span class="n">kvec</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="n">cstar</span>
        <span class="n">phasefac</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mf">2.0</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">i</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">atoms</span><span class="p">,</span> <span class="n">kcart</span><span class="p">))</span>
        <span class="n">cspins</span> <span class="o">+=</span> <span class="n">basisvecs</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span><span class="o">*</span><span class="n">phasefac</span><span class="p">[:,</span> <span class="n">np</span><span class="o">.</span><span class="n">newaxis</span><span class="p">]</span>
    <span class="n">spins</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">cspins</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">imag</span><span class="p">(</span><span class="n">cspins</span><span class="p">))</span><span class="o">.</span><span class="n">max</span><span class="p">()</span> <span class="o">&gt;</span> <span class="mf">0.0001</span><span class="p">:</span>
        <span class="k">print</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">imag</span><span class="p">(</span><span class="n">cspins</span><span class="p">))</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
        <span class="k">print</span> <span class="s1">&#39;Warning: basis vectors resulted in complex spins.&#39;</span>
        <span class="k">print</span> <span class="s1">&#39;Imaginary parts have been discarded.&#39;</span>

    <span class="k">return</span> <span class="n">spins</span></div>

<div class="viewcode-block" id="generateFromUnitCell"><a class="viewcode-back" href="../../../source/diffpy.mpdf.html#diffpy.mpdf.magstructure.generateFromUnitCell">[docs]</a><span class="k">def</span> <span class="nf">generateFromUnitCell</span><span class="p">(</span><span class="n">unitcell</span><span class="p">,</span> <span class="n">atombasis</span><span class="p">,</span> <span class="n">spinbasis</span><span class="p">,</span> <span class="n">rmax</span><span class="o">=</span><span class="mf">30.0</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Generate array of atomic Cartesian coordinates from a given structure.</span>

<span class="sd">    Args:</span>
<span class="sd">        unitcell (numpy array): np.array([avec, bvec, cvec])</span>
<span class="sd">        atombasis (numpy array): gives positions of magnetic atoms in</span>
<span class="sd">            fractional coordinates; np.array([pos1, pos2, pos3, ...])</span>
<span class="sd">        spinbasis (numpy array): gives orientations of the magnetic moments</span>
<span class="sd">            in the unit cell, in the same order as atombasis</span>
<span class="sd">        rmax (float): largest distance from central atom that should be</span>
<span class="sd">            included</span>

<span class="sd">    Returns:</span>
<span class="sd">        atoms = numpy array of triples giving the Cartesian coordinates of all</span>
<span class="sd">              the magnetic atoms. Atom closest to the origin placed first in</span>
<span class="sd">              array.</span>
<span class="sd">        spins = numpy array of triples giving the Cartesian coordinates of all</span>
<span class="sd">              the spins in the structure, in the same order as atoms.</span>

<span class="sd">    Note: This will only work well for structures that can be expressed with a</span>
<span class="sd">        unit cell that is close to orthorhombic or higher symmetry.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">atombasis</span><span class="p">)</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">atombasis</span> <span class="o">=</span> <span class="p">[</span><span class="n">atombasis</span><span class="p">]</span>        
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">spinbasis</span><span class="p">)</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">spinbasis</span> <span class="o">=</span> <span class="p">[</span><span class="n">spinbasis</span><span class="p">]</span>        
    <span class="n">cellwithatoms</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">atombasis</span><span class="p">,</span> <span class="n">unitcell</span><span class="p">)</span> <span class="c1">### check this</span>
    <span class="n">radius</span> <span class="o">=</span> <span class="n">rmax</span><span class="o">+</span><span class="mf">15.0</span>
    <span class="n">dim1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">radius</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">unitcell</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
    <span class="n">dim2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">radius</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">unitcell</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
    <span class="n">dim3</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">radius</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">unitcell</span><span class="p">[</span><span class="mi">2</span><span class="p">]))</span>

    <span class="c1">### generate the coordinates of each unit cell</span>
    <span class="n">ocoords</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mgrid</span><span class="p">[</span><span class="o">-</span><span class="n">dim1</span><span class="p">:</span><span class="n">dim1</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="n">dim2</span><span class="p">:</span><span class="n">dim2</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="n">dim3</span><span class="p">:</span><span class="n">dim3</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span><span class="o">.</span><span class="n">ravel</span><span class="p">()</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="mi">2</span><span class="o">*</span><span class="n">dim1</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">dim2</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">dim3</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span> <span class="mi">3</span><span class="p">)</span>
    <span class="n">latos</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">ocoords</span><span class="p">,</span> <span class="n">unitcell</span><span class="p">)</span>

    <span class="c1">### select points within a desired radius from origin</span>
    <span class="n">latos</span> <span class="o">=</span> <span class="n">latos</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">apply_along_axis</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">latos</span><span class="p">)</span> <span class="o">&lt;=</span>
                           <span class="p">(</span><span class="n">rmax</span><span class="o">+</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">unitcell</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">))))]</span>

    <span class="c1">## rearrange latos array so that [0, 0, 0] is the first one (for convenience)</span>
    <span class="n">latos</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">latos</span> <span class="o">==</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">))]</span> <span class="o">=</span> <span class="n">latos</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">latos</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>

    <span class="c1">### create list of all atomic positions</span>
    <span class="n">atoms</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">([</span><span class="nb">len</span><span class="p">(</span><span class="n">latos</span><span class="p">)</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span><span class="n">cellwithatoms</span><span class="p">),</span> <span class="mi">3</span><span class="p">])</span>
    <span class="n">spins</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty_like</span><span class="p">(</span><span class="n">atoms</span><span class="p">)</span>
    <span class="n">index</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">lato</span> <span class="ow">in</span> <span class="n">latos</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">j</span><span class="p">,</span> <span class="n">atompos</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">cellwithatoms</span><span class="p">):</span>
            <span class="n">atoms</span><span class="p">[</span><span class="n">index</span><span class="p">]</span> <span class="o">=</span> <span class="n">lato</span> <span class="o">+</span> <span class="n">atompos</span>
            <span class="n">spins</span><span class="p">[</span><span class="n">index</span><span class="p">]</span> <span class="o">=</span> <span class="n">spinbasis</span><span class="p">[</span><span class="n">j</span><span class="p">]</span>
            <span class="n">index</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="k">return</span> <span class="n">atoms</span><span class="p">,</span> <span class="n">spins</span></div>

<div class="viewcode-block" id="getFFparams"><a class="viewcode-back" href="../../../source/diffpy.mpdf.html#diffpy.mpdf.magstructure.getFFparams">[docs]</a><span class="k">def</span> <span class="nf">getFFparams</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">j2</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Get list of parameters for approximation of magnetic form factor</span>

<span class="sd">    Args:</span>
<span class="sd">        name (str): Name of magnetic ion in form &#39;Mn2&#39; for Mn2+, etc.</span>
<span class="sd">        j2 (boolean): True of the j2 approximation should be calculated;</span>
<span class="sd">            otherwise, the j0 approximation is calculated.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Python list of the 7 coefficients in the analytical approximation</span>
<span class="sd">            given at e.g. https://www.ill.eu/sites/ccsl/ffacts/ffachtml.html</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">j2</span><span class="p">:</span>
        <span class="n">j0dict</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;Am2&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.4743</span><span class="p">,</span> <span class="mf">21.7761</span><span class="p">,</span> <span class="mf">1.58</span><span class="p">,</span> <span class="mf">5.6902</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.0779</span><span class="p">,</span> <span class="mf">4.1451</span><span class="p">,</span> <span class="mf">0.0218</span><span class="p">],</span>
                  <span class="s1">&#39;Am3&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.4239</span><span class="p">,</span> <span class="mf">19.5739</span><span class="p">,</span> <span class="mf">1.4573</span><span class="p">,</span> <span class="mf">5.8722</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.9052</span><span class="p">,</span> <span class="mf">3.9682</span><span class="p">,</span> <span class="mf">0.0238</span><span class="p">],</span>
                  <span class="s1">&#39;Am4&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.3737</span><span class="p">,</span> <span class="mf">17.8625</span><span class="p">,</span> <span class="mf">1.3521</span><span class="p">,</span> <span class="mf">6.0426</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.7514</span><span class="p">,</span> <span class="mf">3.7199</span><span class="p">,</span> <span class="mf">0.0258</span><span class="p">],</span>
                  <span class="s1">&#39;Am5&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.2956</span><span class="p">,</span> <span class="mf">17.3725</span><span class="p">,</span> <span class="mf">1.4525</span><span class="p">,</span> <span class="mf">6.0734</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.7755</span><span class="p">,</span> <span class="mf">3.6619</span><span class="p">,</span> <span class="mf">0.0277</span><span class="p">],</span>
                  <span class="s1">&#39;Am6&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.2302</span><span class="p">,</span> <span class="mf">16.9533</span><span class="p">,</span> <span class="mf">1.4864</span><span class="p">,</span> <span class="mf">6.1159</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.7457</span><span class="p">,</span> <span class="mf">3.5426</span><span class="p">,</span> <span class="mf">0.0294</span><span class="p">],</span>
                  <span class="s1">&#39;Am7&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.3601</span><span class="p">,</span> <span class="mf">12.7299</span><span class="p">,</span> <span class="mf">1.964</span><span class="p">,</span> <span class="mf">5.1203</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.356</span><span class="p">,</span> <span class="mf">3.7142</span><span class="p">,</span> <span class="mf">0.0316</span><span class="p">],</span>
                  <span class="s1">&#39;Ce2&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.2953</span><span class="p">,</span> <span class="mf">17.6846</span><span class="p">,</span> <span class="mf">0.2923</span><span class="p">,</span> <span class="mf">6.7329</span><span class="p">,</span> <span class="mf">0.4313</span><span class="p">,</span> <span class="mf">5.3827</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0194</span><span class="p">],</span>
                  <span class="s1">&#39;Co0&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.4139</span><span class="p">,</span> <span class="mf">16.1616</span><span class="p">,</span> <span class="mf">0.6013</span><span class="p">,</span> <span class="mf">4.7805</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.1518</span><span class="p">,</span> <span class="mf">0.021</span><span class="p">,</span> <span class="mf">0.1345</span><span class="p">],</span>
                  <span class="s1">&#39;Co1&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.099</span><span class="p">,</span> <span class="mf">33.1252</span><span class="p">,</span> <span class="mf">0.3645</span><span class="p">,</span> <span class="mf">15.1768</span><span class="p">,</span> <span class="mf">0.547</span><span class="p">,</span> <span class="mf">5.0081</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0109</span><span class="p">],</span>
                  <span class="s1">&#39;Co2&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.4332</span><span class="p">,</span> <span class="mf">14.3553</span><span class="p">,</span> <span class="mf">0.5857</span><span class="p">,</span> <span class="mf">4.6077</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0382</span><span class="p">,</span> <span class="mf">0.1338</span><span class="p">,</span> <span class="mf">0.0179</span><span class="p">],</span>
                  <span class="s1">&#39;Co3&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.3902</span><span class="p">,</span> <span class="mf">12.5078</span><span class="p">,</span> <span class="mf">0.6324</span><span class="p">,</span> <span class="mf">4.4574</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.15</span><span class="p">,</span> <span class="mf">0.0343</span><span class="p">,</span> <span class="mf">0.1272</span><span class="p">],</span>
                  <span class="s1">&#39;Co4&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.3515</span><span class="p">,</span> <span class="mf">10.7785</span><span class="p">,</span> <span class="mf">0.6778</span><span class="p">,</span> <span class="mf">4.2343</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0389</span><span class="p">,</span> <span class="mf">0.2409</span><span class="p">,</span> <span class="mf">0.0098</span><span class="p">],</span>
                  <span class="s1">&#39;Cr0&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.1135</span><span class="p">,</span> <span class="mf">45.199</span><span class="p">,</span> <span class="mf">0.3481</span><span class="p">,</span> <span class="mf">19.4931</span><span class="p">,</span> <span class="mf">0.5477</span><span class="p">,</span> <span class="mf">7.3542</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0092</span><span class="p">],</span>
                  <span class="s1">&#39;Cr1&#39;</span><span class="p">:</span> <span class="p">[</span><span class="o">-</span><span class="mf">0.0977</span><span class="p">,</span> <span class="mf">0.047</span><span class="p">,</span> <span class="mf">0.4544</span><span class="p">,</span> <span class="mf">26.0054</span><span class="p">,</span> <span class="mf">0.5579</span><span class="p">,</span> <span class="mf">7.4892</span><span class="p">,</span> <span class="mf">0.0831</span><span class="p">],</span>
                  <span class="s1">&#39;Cr2&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">1.2024</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0055</span><span class="p">,</span> <span class="mf">0.4158</span><span class="p">,</span> <span class="mf">20.5475</span><span class="p">,</span> <span class="mf">0.6032</span><span class="p">,</span> <span class="mf">6.956</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.2218</span><span class="p">],</span>
                  <span class="s1">&#39;Cr3&#39;</span><span class="p">:</span> <span class="p">[</span><span class="o">-</span><span class="mf">0.3094</span><span class="p">,</span> <span class="mf">0.0274</span><span class="p">,</span> <span class="mf">0.368</span><span class="p">,</span> <span class="mf">17.0355</span><span class="p">,</span> <span class="mf">0.6559</span><span class="p">,</span> <span class="mf">6.5236</span><span class="p">,</span> <span class="mf">0.2856</span><span class="p">],</span>
                  <span class="s1">&#39;Cr4&#39;</span><span class="p">:</span> <span class="p">[</span><span class="o">-</span><span class="mf">0.232</span><span class="p">,</span> <span class="mf">0.0433</span><span class="p">,</span> <span class="mf">0.3101</span><span class="p">,</span> <span class="mf">14.9518</span><span class="p">,</span> <span class="mf">0.7182</span><span class="p">,</span> <span class="mf">6.1726</span><span class="p">,</span> <span class="mf">0.2042</span><span class="p">],</span>
                  <span class="s1">&#39;Cu0&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.0909</span><span class="p">,</span> <span class="mf">34.9838</span><span class="p">,</span> <span class="mf">0.4088</span><span class="p">,</span> <span class="mf">11.4432</span><span class="p">,</span> <span class="mf">0.5128</span><span class="p">,</span> <span class="mf">3.8248</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0124</span><span class="p">],</span>
                  <span class="s1">&#39;Cu1&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.0749</span><span class="p">,</span> <span class="mf">34.9656</span><span class="p">,</span> <span class="mf">0.4147</span><span class="p">,</span> <span class="mf">11.7642</span><span class="p">,</span> <span class="mf">0.5238</span><span class="p">,</span> <span class="mf">3.8497</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0127</span><span class="p">],</span>
                  <span class="s1">&#39;Cu2&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.0232</span><span class="p">,</span> <span class="mf">34.9686</span><span class="p">,</span> <span class="mf">0.4023</span><span class="p">,</span> <span class="mf">11.564</span><span class="p">,</span> <span class="mf">0.5882</span><span class="p">,</span> <span class="mf">3.8428</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0137</span><span class="p">],</span>
                  <span class="s1">&#39;Cu3&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.0031</span><span class="p">,</span> <span class="mf">34.9074</span><span class="p">,</span> <span class="mf">0.3582</span><span class="p">,</span> <span class="mf">10.9138</span><span class="p">,</span> <span class="mf">0.6531</span><span class="p">,</span> <span class="mf">3.8279</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0147</span><span class="p">],</span>
                  <span class="s1">&#39;Cu4&#39;</span><span class="p">:</span> <span class="p">[</span><span class="o">-</span><span class="mf">0.0132</span><span class="p">,</span> <span class="mf">30.6817</span><span class="p">,</span> <span class="mf">0.2801</span><span class="p">,</span> <span class="mf">11.1626</span><span class="p">,</span> <span class="mf">0.749</span><span class="p">,</span> <span class="mf">3.8172</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0165</span><span class="p">],</span>
                  <span class="s1">&#39;Dy2&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.1308</span><span class="p">,</span> <span class="mf">18.3155</span><span class="p">,</span> <span class="mf">0.3118</span><span class="p">,</span> <span class="mf">7.6645</span><span class="p">,</span> <span class="mf">0.5795</span><span class="p">,</span> <span class="mf">3.1469</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0226</span><span class="p">],</span>
                  <span class="s1">&#39;Dy3&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.1157</span><span class="p">,</span> <span class="mf">15.0732</span><span class="p">,</span> <span class="mf">0.327</span><span class="p">,</span> <span class="mf">6.7991</span><span class="p">,</span> <span class="mf">0.5821</span><span class="p">,</span> <span class="mf">3.0202</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0249</span><span class="p">],</span>
                  <span class="s1">&#39;Er2&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.1122</span><span class="p">,</span> <span class="mf">18.1223</span><span class="p">,</span> <span class="mf">0.3462</span><span class="p">,</span> <span class="mf">6.9106</span><span class="p">,</span> <span class="mf">0.5649</span><span class="p">,</span> <span class="mf">2.7614</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0235</span><span class="p">],</span>
                  <span class="s1">&#39;Er3&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.0586</span><span class="p">,</span> <span class="mf">17.9802</span><span class="p">,</span> <span class="mf">0.354</span><span class="p">,</span> <span class="mf">7.0964</span><span class="p">,</span> <span class="mf">0.6126</span><span class="p">,</span> <span class="mf">2.7482</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0251</span><span class="p">],</span>
                  <span class="s1">&#39;Eu2&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.0755</span><span class="p">,</span> <span class="mf">25.296</span><span class="p">,</span> <span class="mf">0.3001</span><span class="p">,</span> <span class="mf">11.5993</span><span class="p">,</span> <span class="mf">0.6438</span><span class="p">,</span> <span class="mf">4.0252</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0196</span><span class="p">],</span>
                  <span class="s1">&#39;Eu3&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.0204</span><span class="p">,</span> <span class="mf">25.3078</span><span class="p">,</span> <span class="mf">0.301</span><span class="p">,</span> <span class="mf">11.4744</span><span class="p">,</span> <span class="mf">0.7005</span><span class="p">,</span> <span class="mf">3.942</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.022</span><span class="p">],</span>
                  <span class="s1">&#39;Fe0&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.0706</span><span class="p">,</span> <span class="mf">35.0085</span><span class="p">,</span> <span class="mf">0.3589</span><span class="p">,</span> <span class="mf">15.3583</span><span class="p">,</span> <span class="mf">0.5819</span><span class="p">,</span> <span class="mf">5.5606</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0114</span><span class="p">],</span>
                  <span class="s1">&#39;Fe1&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.1251</span><span class="p">,</span> <span class="mf">34.9633</span><span class="p">,</span> <span class="mf">0.3629</span><span class="p">,</span> <span class="mf">15.5144</span><span class="p">,</span> <span class="mf">0.5223</span><span class="p">,</span> <span class="mf">5.5914</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0105</span><span class="p">],</span>
                  <span class="s1">&#39;Fe2&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.0263</span><span class="p">,</span> <span class="mf">34.9597</span><span class="p">,</span> <span class="mf">0.3668</span><span class="p">,</span> <span class="mf">15.9435</span><span class="p">,</span> <span class="mf">0.6188</span><span class="p">,</span> <span class="mf">5.5935</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0119</span><span class="p">],</span>
                  <span class="s1">&#39;Fe3&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.3972</span><span class="p">,</span> <span class="mf">13.2442</span><span class="p">,</span> <span class="mf">0.6295</span><span class="p">,</span> <span class="mf">4.9034</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0314</span><span class="p">,</span> <span class="mf">0.3496</span><span class="p">,</span> <span class="mf">0.0044</span><span class="p">],</span>
                  <span class="s1">&#39;Fe4&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.3782</span><span class="p">,</span> <span class="mf">11.38</span><span class="p">,</span> <span class="mf">0.6556</span><span class="p">,</span> <span class="mf">4.592</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0346</span><span class="p">,</span> <span class="mf">0.4833</span><span class="p">,</span> <span class="mf">0.0005</span><span class="p">],</span>
                  <span class="s1">&#39;Gd2&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.0636</span><span class="p">,</span> <span class="mf">25.3823</span><span class="p">,</span> <span class="mf">0.3033</span><span class="p">,</span> <span class="mf">11.2125</span><span class="p">,</span> <span class="mf">0.6528</span><span class="p">,</span> <span class="mf">3.7877</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0199</span><span class="p">],</span>
                  <span class="s1">&#39;Gd3&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.0186</span><span class="p">,</span> <span class="mf">25.3867</span><span class="p">,</span> <span class="mf">0.2895</span><span class="p">,</span> <span class="mf">11.1421</span><span class="p">,</span> <span class="mf">0.7135</span><span class="p">,</span> <span class="mf">3.752</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0217</span><span class="p">],</span>
                  <span class="s1">&#39;Ho2&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.0995</span><span class="p">,</span> <span class="mf">18.1761</span><span class="p">,</span> <span class="mf">0.3305</span><span class="p">,</span> <span class="mf">7.8556</span><span class="p">,</span> <span class="mf">0.5921</span><span class="p">,</span> <span class="mf">2.9799</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.023</span><span class="p">],</span>
                  <span class="s1">&#39;Ho3&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.0566</span><span class="p">,</span> <span class="mf">18.3176</span><span class="p">,</span> <span class="mf">0.3365</span><span class="p">,</span> <span class="mf">7.688</span><span class="p">,</span> <span class="mf">0.6317</span><span class="p">,</span> <span class="mf">2.9427</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0248</span><span class="p">],</span>
                  <span class="s1">&#39;Mn0&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.2438</span><span class="p">,</span> <span class="mf">24.9629</span><span class="p">,</span> <span class="mf">0.1472</span><span class="p">,</span> <span class="mf">15.6728</span><span class="p">,</span> <span class="mf">0.6189</span><span class="p">,</span> <span class="mf">6.5403</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0105</span><span class="p">],</span>
                  <span class="s1">&#39;Mn1&#39;</span><span class="p">:</span> <span class="p">[</span><span class="o">-</span><span class="mf">0.0138</span><span class="p">,</span> <span class="mf">0.4213</span><span class="p">,</span> <span class="mf">0.4231</span><span class="p">,</span> <span class="mf">24.668</span><span class="p">,</span> <span class="mf">0.5905</span><span class="p">,</span> <span class="mf">6.6545</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.001</span><span class="p">],</span>
                  <span class="s1">&#39;Mn2&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.422</span><span class="p">,</span> <span class="mf">17.684</span><span class="p">,</span> <span class="mf">0.5948</span><span class="p">,</span> <span class="mf">6.005</span><span class="p">,</span> <span class="mf">0.0043</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.609</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0219</span><span class="p">],</span>
                  <span class="s1">&#39;Mn3&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.4198</span><span class="p">,</span> <span class="mf">14.2829</span><span class="p">,</span> <span class="mf">0.6054</span><span class="p">,</span> <span class="mf">5.4689</span><span class="p">,</span> <span class="mf">0.9241</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0088</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.9498</span><span class="p">],</span>
                  <span class="s1">&#39;Mn4&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.376</span><span class="p">,</span> <span class="mf">12.5661</span><span class="p">,</span> <span class="mf">0.6602</span><span class="p">,</span> <span class="mf">5.1329</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0372</span><span class="p">,</span> <span class="mf">0.563</span><span class="p">,</span> <span class="mf">0.0011</span><span class="p">],</span>
                  <span class="s1">&#39;Mo0&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.1806</span><span class="p">,</span> <span class="mf">49.0568</span><span class="p">,</span> <span class="mf">1.2306</span><span class="p">,</span> <span class="mf">14.7859</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.4268</span><span class="p">,</span> <span class="mf">6.9866</span><span class="p">,</span> <span class="mf">0.0171</span><span class="p">],</span>
                  <span class="s1">&#39;Mo1&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.35</span><span class="p">,</span> <span class="mf">48.0354</span><span class="p">,</span> <span class="mf">1.0305</span><span class="p">,</span> <span class="mf">15.0604</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.3929</span><span class="p">,</span> <span class="mf">7.479</span><span class="p">,</span> <span class="mf">0.0139</span><span class="p">],</span>
                  <span class="s1">&#39;Nb0&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.3946</span><span class="p">,</span> <span class="mf">49.2297</span><span class="p">,</span> <span class="mf">1.3197</span><span class="p">,</span> <span class="mf">14.8216</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.7269</span><span class="p">,</span> <span class="mf">9.6156</span><span class="p">,</span> <span class="mf">0.0129</span><span class="p">],</span>
                  <span class="s1">&#39;Nb1&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.4572</span><span class="p">,</span> <span class="mf">49.9182</span><span class="p">,</span> <span class="mf">1.0274</span><span class="p">,</span> <span class="mf">15.7256</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.4962</span><span class="p">,</span> <span class="mf">9.1573</span><span class="p">,</span> <span class="mf">0.0118</span><span class="p">],</span>
                  <span class="s1">&#39;Nd2&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.1645</span><span class="p">,</span> <span class="mf">25.0453</span><span class="p">,</span> <span class="mf">0.2522</span><span class="p">,</span> <span class="mf">11.9782</span><span class="p">,</span> <span class="mf">0.6012</span><span class="p">,</span> <span class="mf">4.9461</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.018</span><span class="p">],</span>
                  <span class="s1">&#39;Nd3&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.054</span><span class="p">,</span> <span class="mf">25.0293</span><span class="p">,</span> <span class="mf">0.3101</span><span class="p">,</span> <span class="mf">12.102</span><span class="p">,</span> <span class="mf">0.6575</span><span class="p">,</span> <span class="mf">4.7223</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0216</span><span class="p">],</span>
                  <span class="s1">&#39;Ni0&#39;</span><span class="p">:</span> <span class="p">[</span><span class="o">-</span><span class="mf">0.0172</span><span class="p">,</span> <span class="mf">35.7392</span><span class="p">,</span> <span class="mf">0.3174</span><span class="p">,</span> <span class="mf">14.2689</span><span class="p">,</span> <span class="mf">0.7136</span><span class="p">,</span> <span class="mf">4.5661</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0143</span><span class="p">],</span>
                  <span class="s1">&#39;Ni1&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.0705</span><span class="p">,</span> <span class="mf">35.8561</span><span class="p">,</span> <span class="mf">0.3984</span><span class="p">,</span> <span class="mf">13.8042</span><span class="p">,</span> <span class="mf">0.5427</span><span class="p">,</span> <span class="mf">4.3965</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0118</span><span class="p">],</span>
                  <span class="s1">&#39;Ni2&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.0163</span><span class="p">,</span> <span class="mf">35.8826</span><span class="p">,</span> <span class="mf">0.3916</span><span class="p">,</span> <span class="mf">13.2233</span><span class="p">,</span> <span class="mf">0.6052</span><span class="p">,</span> <span class="mf">4.3388</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0133</span><span class="p">],</span>
                  <span class="s1">&#39;Ni3&#39;</span><span class="p">:</span> <span class="p">[</span><span class="o">-</span><span class="mf">0.0134</span><span class="p">,</span> <span class="mf">35.8677</span><span class="p">,</span> <span class="mf">0.2678</span><span class="p">,</span> <span class="mf">12.3326</span><span class="p">,</span> <span class="mf">0.7614</span><span class="p">,</span> <span class="mf">4.2369</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0162</span><span class="p">],</span>
                  <span class="s1">&#39;Ni4&#39;</span><span class="p">:</span> <span class="p">[</span><span class="o">-</span><span class="mf">0.009</span><span class="p">,</span> <span class="mf">35.8614</span><span class="p">,</span> <span class="mf">0.2776</span><span class="p">,</span> <span class="mf">11.7904</span><span class="p">,</span> <span class="mf">0.7474</span><span class="p">,</span> <span class="mf">4.2011</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0163</span><span class="p">],</span>
                  <span class="s1">&#39;Np3&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.5157</span><span class="p">,</span> <span class="mf">20.8654</span><span class="p">,</span> <span class="mf">2.2784</span><span class="p">,</span> <span class="mf">5.893</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.8163</span><span class="p">,</span> <span class="mf">4.8457</span><span class="p">,</span> <span class="mf">0.0211</span><span class="p">],</span>
                  <span class="s1">&#39;Np4&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.4206</span><span class="p">,</span> <span class="mf">19.8046</span><span class="p">,</span> <span class="mf">2.8004</span><span class="p">,</span> <span class="mf">5.9783</span><span class="p">,</span> <span class="o">-</span><span class="mf">2.2436</span><span class="p">,</span> <span class="mf">4.9848</span><span class="p">,</span> <span class="mf">0.0228</span><span class="p">],</span>
                  <span class="s1">&#39;Np5&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.3692</span><span class="p">,</span> <span class="mf">18.19</span><span class="p">,</span> <span class="mf">3.151</span><span class="p">,</span> <span class="mf">5.85</span><span class="p">,</span> <span class="o">-</span><span class="mf">2.5446</span><span class="p">,</span> <span class="mf">4.9164</span><span class="p">,</span> <span class="mf">0.0248</span><span class="p">],</span>
                  <span class="s1">&#39;Np6&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.2929</span><span class="p">,</span> <span class="mf">17.5611</span><span class="p">,</span> <span class="mf">3.4866</span><span class="p">,</span> <span class="mf">5.7847</span><span class="p">,</span> <span class="o">-</span><span class="mf">2.8066</span><span class="p">,</span> <span class="mf">4.8707</span><span class="p">,</span> <span class="mf">0.0267</span><span class="p">],</span>
                  <span class="s1">&#39;Pd0&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.2003</span><span class="p">,</span> <span class="mf">29.3633</span><span class="p">,</span> <span class="mf">1.1446</span><span class="p">,</span> <span class="mf">9.5993</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.3689</span><span class="p">,</span> <span class="mf">4.0423</span><span class="p">,</span> <span class="mf">0.0251</span><span class="p">],</span>
                  <span class="s1">&#39;Pd1&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.5033</span><span class="p">,</span> <span class="mf">24.5037</span><span class="p">,</span> <span class="mf">1.9982</span><span class="p">,</span> <span class="mf">6.9082</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.524</span><span class="p">,</span> <span class="mf">5.5133</span><span class="p">,</span> <span class="mf">0.0213</span><span class="p">],</span>
                  <span class="s1">&#39;Pr3&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.0504</span><span class="p">,</span> <span class="mf">24.9989</span><span class="p">,</span> <span class="mf">0.2572</span><span class="p">,</span> <span class="mf">12.0377</span><span class="p">,</span> <span class="mf">0.7142</span><span class="p">,</span> <span class="mf">5.0039</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0219</span><span class="p">],</span>
                  <span class="s1">&#39;Pu3&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.384</span><span class="p">,</span> <span class="mf">16.6793</span><span class="p">,</span> <span class="mf">3.1049</span><span class="p">,</span> <span class="mf">5.421</span><span class="p">,</span> <span class="o">-</span><span class="mf">2.5148</span><span class="p">,</span> <span class="mf">4.5512</span><span class="p">,</span> <span class="mf">0.0263</span><span class="p">],</span>
                  <span class="s1">&#39;Pu4&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.4934</span><span class="p">,</span> <span class="mf">16.8355</span><span class="p">,</span> <span class="mf">1.6394</span><span class="p">,</span> <span class="mf">5.6384</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.1581</span><span class="p">,</span> <span class="mf">4.1399</span><span class="p">,</span> <span class="mf">0.0248</span><span class="p">],</span>
                  <span class="s1">&#39;Pu5&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.3888</span><span class="p">,</span> <span class="mf">16.5592</span><span class="p">,</span> <span class="mf">2.0362</span><span class="p">,</span> <span class="mf">5.6567</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.4515</span><span class="p">,</span> <span class="mf">4.2552</span><span class="p">,</span> <span class="mf">0.0267</span><span class="p">],</span>
                  <span class="s1">&#39;Pu6&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.3172</span><span class="p">,</span> <span class="mf">16.0507</span><span class="p">,</span> <span class="mf">3.4654</span><span class="p">,</span> <span class="mf">5.3507</span><span class="p">,</span> <span class="o">-</span><span class="mf">2.8102</span><span class="p">,</span> <span class="mf">4.5133</span><span class="p">,</span> <span class="mf">0.0281</span><span class="p">],</span>
                  <span class="s1">&#39;Rh0&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.0976</span><span class="p">,</span> <span class="mf">49.8825</span><span class="p">,</span> <span class="mf">1.1601</span><span class="p">,</span> <span class="mf">11.8307</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.2789</span><span class="p">,</span> <span class="mf">4.1266</span><span class="p">,</span> <span class="mf">0.0234</span><span class="p">],</span>
                  <span class="s1">&#39;Rh1&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.3342</span><span class="p">,</span> <span class="mf">29.7564</span><span class="p">,</span> <span class="mf">1.2209</span><span class="p">,</span> <span class="mf">9.4384</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5755</span><span class="p">,</span> <span class="mf">5.332</span><span class="p">,</span> <span class="mf">0.021</span><span class="p">],</span>
                  <span class="s1">&#39;Ru0&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.1069</span><span class="p">,</span> <span class="mf">49.4238</span><span class="p">,</span> <span class="mf">1.1912</span><span class="p">,</span> <span class="mf">12.7417</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.3176</span><span class="p">,</span> <span class="mf">4.9125</span><span class="p">,</span> <span class="mf">0.0213</span><span class="p">],</span>
                  <span class="s1">&#39;Ru1&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.441</span><span class="p">,</span> <span class="mf">33.3086</span><span class="p">,</span> <span class="mf">1.4775</span><span class="p">,</span> <span class="mf">9.5531</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.9361</span><span class="p">,</span> <span class="mf">6.722</span><span class="p">,</span> <span class="mf">0.0176</span><span class="p">],</span>
                  <span class="s1">&#39;Sc0&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.2512</span><span class="p">,</span> <span class="mf">90.0296</span><span class="p">,</span> <span class="mf">0.329</span><span class="p">,</span> <span class="mf">39.4021</span><span class="p">,</span> <span class="mf">0.4235</span><span class="p">,</span> <span class="mf">14.3222</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0043</span><span class="p">],</span>
                  <span class="s1">&#39;Sc1&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.4889</span><span class="p">,</span> <span class="mf">51.1603</span><span class="p">,</span> <span class="mf">0.5203</span><span class="p">,</span> <span class="mf">14.0764</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0286</span><span class="p">,</span> <span class="mf">0.1792</span><span class="p">,</span> <span class="mf">0.0185</span><span class="p">],</span>
                  <span class="s1">&#39;Sc2&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.5048</span><span class="p">,</span> <span class="mf">31.4035</span><span class="p">,</span> <span class="mf">0.5186</span><span class="p">,</span> <span class="mf">10.9897</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0241</span><span class="p">,</span> <span class="mf">1.1831</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">],</span>
                  <span class="s1">&#39;Sm2&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.0909</span><span class="p">,</span> <span class="mf">25.2032</span><span class="p">,</span> <span class="mf">0.3037</span><span class="p">,</span> <span class="mf">11.8562</span><span class="p">,</span> <span class="mf">0.625</span><span class="p">,</span> <span class="mf">4.2366</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.02</span><span class="p">],</span>
                  <span class="s1">&#39;Sm3&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.0288</span><span class="p">,</span> <span class="mf">25.2068</span><span class="p">,</span> <span class="mf">0.2973</span><span class="p">,</span> <span class="mf">11.8311</span><span class="p">,</span> <span class="mf">0.6954</span><span class="p">,</span> <span class="mf">4.2117</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0213</span><span class="p">],</span>
                  <span class="s1">&#39;Tb2&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.0547</span><span class="p">,</span> <span class="mf">25.5086</span><span class="p">,</span> <span class="mf">0.3171</span><span class="p">,</span> <span class="mf">10.5911</span><span class="p">,</span> <span class="mf">0.649</span><span class="p">,</span> <span class="mf">3.5171</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0212</span><span class="p">],</span>
                  <span class="s1">&#39;Tb3&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.0177</span><span class="p">,</span> <span class="mf">25.5095</span><span class="p">,</span> <span class="mf">0.2921</span><span class="p">,</span> <span class="mf">10.5769</span><span class="p">,</span> <span class="mf">0.7133</span><span class="p">,</span> <span class="mf">3.5122</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0231</span><span class="p">],</span>
                  <span class="s1">&#39;Tc0&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.1298</span><span class="p">,</span> <span class="mf">49.6611</span><span class="p">,</span> <span class="mf">1.1656</span><span class="p">,</span> <span class="mf">14.1307</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.3134</span><span class="p">,</span> <span class="mf">5.5129</span><span class="p">,</span> <span class="mf">0.0195</span><span class="p">],</span>
                  <span class="s1">&#39;Tc1&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.2674</span><span class="p">,</span> <span class="mf">48.9566</span><span class="p">,</span> <span class="mf">0.9569</span><span class="p">,</span> <span class="mf">15.1413</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.2387</span><span class="p">,</span> <span class="mf">5.4578</span><span class="p">,</span> <span class="mf">0.016</span><span class="p">],</span>
                  <span class="s1">&#39;Ti0&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.4657</span><span class="p">,</span> <span class="mf">33.5898</span><span class="p">,</span> <span class="mf">0.549</span><span class="p">,</span> <span class="mf">9.8791</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0291</span><span class="p">,</span> <span class="mf">0.3232</span><span class="p">,</span> <span class="mf">0.0123</span><span class="p">],</span>
                  <span class="s1">&#39;Ti1&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.5093</span><span class="p">,</span> <span class="mf">36.7033</span><span class="p">,</span> <span class="mf">0.5032</span><span class="p">,</span> <span class="mf">10.3713</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0263</span><span class="p">,</span> <span class="mf">0.3106</span><span class="p">,</span> <span class="mf">0.0116</span><span class="p">],</span>
                  <span class="s1">&#39;Ti2&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.5091</span><span class="p">,</span> <span class="mf">24.9763</span><span class="p">,</span> <span class="mf">0.5162</span><span class="p">,</span> <span class="mf">8.7569</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0281</span><span class="p">,</span> <span class="mf">0.916</span><span class="p">,</span> <span class="mf">0.0015</span><span class="p">],</span>
                  <span class="s1">&#39;Ti3&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.3571</span><span class="p">,</span> <span class="mf">22.8413</span><span class="p">,</span> <span class="mf">0.6688</span><span class="p">,</span> <span class="mf">8.9306</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0354</span><span class="p">,</span> <span class="mf">0.4833</span><span class="p">,</span> <span class="mf">0.0099</span><span class="p">],</span>
                  <span class="s1">&#39;Tm2&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.0983</span><span class="p">,</span> <span class="mf">18.3236</span><span class="p">,</span> <span class="mf">0.338</span><span class="p">,</span> <span class="mf">6.9178</span><span class="p">,</span> <span class="mf">0.5875</span><span class="p">,</span> <span class="mf">2.6622</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0241</span><span class="p">],</span>
                  <span class="s1">&#39;Tm3&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.0581</span><span class="p">,</span> <span class="mf">15.0922</span><span class="p">,</span> <span class="mf">0.2787</span><span class="p">,</span> <span class="mf">7.8015</span><span class="p">,</span> <span class="mf">0.6854</span><span class="p">,</span> <span class="mf">2.7931</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0224</span><span class="p">],</span>
                  <span class="s1">&#39;U3&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.5058</span><span class="p">,</span> <span class="mf">23.2882</span><span class="p">,</span> <span class="mf">1.3464</span><span class="p">,</span> <span class="mf">7.0028</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.8724</span><span class="p">,</span> <span class="mf">4.8683</span><span class="p">,</span> <span class="mf">0.0192</span><span class="p">],</span>
                  <span class="s1">&#39;U4&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.3291</span><span class="p">,</span> <span class="mf">23.5475</span><span class="p">,</span> <span class="mf">1.0836</span><span class="p">,</span> <span class="mf">8.454</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.434</span><span class="p">,</span> <span class="mf">4.1196</span><span class="p">,</span> <span class="mf">0.0214</span><span class="p">],</span>
                  <span class="s1">&#39;U5&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.365</span><span class="p">,</span> <span class="mf">19.8038</span><span class="p">,</span> <span class="mf">3.2199</span><span class="p">,</span> <span class="mf">6.2818</span><span class="p">,</span> <span class="o">-</span><span class="mf">2.6077</span><span class="p">,</span> <span class="mf">5.301</span><span class="p">,</span> <span class="mf">0.0233</span><span class="p">],</span>
                  <span class="s1">&#39;V0&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.4086</span><span class="p">,</span> <span class="mf">28.8109</span><span class="p">,</span> <span class="mf">0.6077</span><span class="p">,</span> <span class="mf">8.5437</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0295</span><span class="p">,</span> <span class="mf">0.2768</span><span class="p">,</span> <span class="mf">0.0123</span><span class="p">],</span>
                  <span class="s1">&#39;V1&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.4444</span><span class="p">,</span> <span class="mf">32.6479</span><span class="p">,</span> <span class="mf">0.5683</span><span class="p">,</span> <span class="mf">9.0971</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.2285</span><span class="p">,</span> <span class="mf">0.0218</span><span class="p">,</span> <span class="mf">0.215</span><span class="p">],</span>
                  <span class="s1">&#39;V2&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.4085</span><span class="p">,</span> <span class="mf">23.8526</span><span class="p">,</span> <span class="mf">0.6091</span><span class="p">,</span> <span class="mf">8.2456</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.1676</span><span class="p">,</span> <span class="mf">0.0415</span><span class="p">,</span> <span class="mf">0.1496</span><span class="p">],</span>
                  <span class="s1">&#39;V3&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.3598</span><span class="p">,</span> <span class="mf">19.3364</span><span class="p">,</span> <span class="mf">0.6632</span><span class="p">,</span> <span class="mf">7.6172</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.3064</span><span class="p">,</span> <span class="mf">0.0296</span><span class="p">,</span> <span class="mf">0.2835</span><span class="p">],</span>
                  <span class="s1">&#39;V4&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.3106</span><span class="p">,</span> <span class="mf">16.816</span><span class="p">,</span> <span class="mf">0.7198</span><span class="p">,</span> <span class="mf">7.0487</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0521</span><span class="p">,</span> <span class="mf">0.302</span><span class="p">,</span> <span class="mf">0.0221</span><span class="p">],</span>
                  <span class="s1">&#39;Y0&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.5915</span><span class="p">,</span> <span class="mf">67.6081</span><span class="p">,</span> <span class="mf">1.5123</span><span class="p">,</span> <span class="mf">17.9004</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.113</span><span class="p">,</span> <span class="mf">14.1359</span><span class="p">,</span> <span class="mf">0.008</span><span class="p">],</span>
                  <span class="s1">&#39;Yb2&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.0855</span><span class="p">,</span> <span class="mf">18.5123</span><span class="p">,</span> <span class="mf">0.2943</span><span class="p">,</span> <span class="mf">7.3734</span><span class="p">,</span> <span class="mf">0.6412</span><span class="p">,</span> <span class="mf">2.6777</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0213</span><span class="p">],</span>
                  <span class="s1">&#39;Yb3&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.0416</span><span class="p">,</span> <span class="mf">16.0949</span><span class="p">,</span> <span class="mf">0.2849</span><span class="p">,</span> <span class="mf">7.8341</span><span class="p">,</span> <span class="mf">0.6961</span><span class="p">,</span> <span class="mf">2.6725</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0229</span><span class="p">],</span>
                  <span class="s1">&#39;Zr0&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.4106</span><span class="p">,</span> <span class="mf">59.9961</span><span class="p">,</span> <span class="mf">1.0543</span><span class="p">,</span> <span class="mf">18.6476</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.4751</span><span class="p">,</span> <span class="mf">10.54</span><span class="p">,</span> <span class="mf">0.0106</span><span class="p">],</span>
                  <span class="s1">&#39;Zr1&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.4532</span><span class="p">,</span> <span class="mf">59.5948</span><span class="p">,</span> <span class="mf">0.7834</span><span class="p">,</span> <span class="mf">21.4357</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.2451</span><span class="p">,</span> <span class="mf">9.036</span><span class="p">,</span> <span class="mf">0.0098</span><span class="p">]}</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">j0dict</span><span class="p">[</span><span class="n">name</span><span class="p">]</span>
        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
            <span class="k">print</span> <span class="s1">&#39;No magnetic form factor found for that element/ion.&#39;</span>
            <span class="k">return</span> <span class="p">[</span><span class="s1">&#39;none&#39;</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">j2dict</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;Am2&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.4743</span><span class="p">,</span> <span class="mf">21.7761</span><span class="p">,</span> <span class="mf">1.58</span><span class="p">,</span> <span class="mf">5.6902</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.0779</span><span class="p">,</span> <span class="mf">4.1451</span><span class="p">,</span> <span class="mf">0.0218</span><span class="p">],</span>
                  <span class="s1">&#39;Am3&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.4239</span><span class="p">,</span> <span class="mf">19.5739</span><span class="p">,</span> <span class="mf">1.4573</span><span class="p">,</span> <span class="mf">5.8722</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.9052</span><span class="p">,</span> <span class="mf">3.9682</span><span class="p">,</span> <span class="mf">0.0238</span><span class="p">],</span>
                  <span class="s1">&#39;Am4&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.3737</span><span class="p">,</span> <span class="mf">17.8625</span><span class="p">,</span> <span class="mf">1.3521</span><span class="p">,</span> <span class="mf">6.0426</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.7514</span><span class="p">,</span> <span class="mf">3.7199</span><span class="p">,</span> <span class="mf">0.0258</span><span class="p">],</span>
                  <span class="s1">&#39;Am5&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.2956</span><span class="p">,</span> <span class="mf">17.3725</span><span class="p">,</span> <span class="mf">1.4525</span><span class="p">,</span> <span class="mf">6.0734</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.7755</span><span class="p">,</span> <span class="mf">3.6619</span><span class="p">,</span> <span class="mf">0.0277</span><span class="p">],</span>
                  <span class="s1">&#39;Am6&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.2302</span><span class="p">,</span> <span class="mf">16.9533</span><span class="p">,</span> <span class="mf">1.4864</span><span class="p">,</span> <span class="mf">6.1159</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.7457</span><span class="p">,</span> <span class="mf">3.5426</span><span class="p">,</span> <span class="mf">0.0294</span><span class="p">],</span>
                  <span class="s1">&#39;Am7&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.3601</span><span class="p">,</span> <span class="mf">12.7299</span><span class="p">,</span> <span class="mf">1.964</span><span class="p">,</span> <span class="mf">5.1203</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.356</span><span class="p">,</span> <span class="mf">3.7142</span><span class="p">,</span> <span class="mf">0.0316</span><span class="p">],</span>
                  <span class="s1">&#39;Ce2&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.2953</span><span class="p">,</span> <span class="mf">17.6846</span><span class="p">,</span> <span class="mf">0.2923</span><span class="p">,</span> <span class="mf">6.7329</span><span class="p">,</span> <span class="mf">0.4313</span><span class="p">,</span> <span class="mf">5.3827</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0194</span><span class="p">],</span>
                  <span class="s1">&#39;Co0&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.4139</span><span class="p">,</span> <span class="mf">16.1616</span><span class="p">,</span> <span class="mf">0.6013</span><span class="p">,</span> <span class="mf">4.7805</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.1518</span><span class="p">,</span> <span class="mf">0.021</span><span class="p">,</span> <span class="mf">0.1345</span><span class="p">],</span>
                  <span class="s1">&#39;Co1&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.099</span><span class="p">,</span> <span class="mf">33.1252</span><span class="p">,</span> <span class="mf">0.3645</span><span class="p">,</span> <span class="mf">15.1768</span><span class="p">,</span> <span class="mf">0.547</span><span class="p">,</span> <span class="mf">5.0081</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0109</span><span class="p">],</span>
                  <span class="s1">&#39;Co2&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.4332</span><span class="p">,</span> <span class="mf">14.3553</span><span class="p">,</span> <span class="mf">0.5857</span><span class="p">,</span> <span class="mf">4.6077</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0382</span><span class="p">,</span> <span class="mf">0.1338</span><span class="p">,</span> <span class="mf">0.0179</span><span class="p">],</span>
                  <span class="s1">&#39;Co3&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.3902</span><span class="p">,</span> <span class="mf">12.5078</span><span class="p">,</span> <span class="mf">0.6324</span><span class="p">,</span> <span class="mf">4.4574</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.15</span><span class="p">,</span> <span class="mf">0.0343</span><span class="p">,</span> <span class="mf">0.1272</span><span class="p">],</span>
                  <span class="s1">&#39;Co4&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.3515</span><span class="p">,</span> <span class="mf">10.7785</span><span class="p">,</span> <span class="mf">0.6778</span><span class="p">,</span> <span class="mf">4.2343</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0389</span><span class="p">,</span> <span class="mf">0.2409</span><span class="p">,</span> <span class="mf">0.0098</span><span class="p">],</span>
                  <span class="s1">&#39;Cr0&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.1135</span><span class="p">,</span> <span class="mf">45.199</span><span class="p">,</span> <span class="mf">0.3481</span><span class="p">,</span> <span class="mf">19.4931</span><span class="p">,</span> <span class="mf">0.5477</span><span class="p">,</span> <span class="mf">7.3542</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0092</span><span class="p">],</span>
                  <span class="s1">&#39;Cr1&#39;</span><span class="p">:</span> <span class="p">[</span><span class="o">-</span><span class="mf">0.0977</span><span class="p">,</span> <span class="mf">0.047</span><span class="p">,</span> <span class="mf">0.4544</span><span class="p">,</span> <span class="mf">26.0054</span><span class="p">,</span> <span class="mf">0.5579</span><span class="p">,</span> <span class="mf">7.4892</span><span class="p">,</span> <span class="mf">0.0831</span><span class="p">],</span>
                  <span class="s1">&#39;Cr2&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">1.2024</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0055</span><span class="p">,</span> <span class="mf">0.4158</span><span class="p">,</span> <span class="mf">20.5475</span><span class="p">,</span> <span class="mf">0.6032</span><span class="p">,</span> <span class="mf">6.956</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.2218</span><span class="p">],</span>
                  <span class="s1">&#39;Cr3&#39;</span><span class="p">:</span> <span class="p">[</span><span class="o">-</span><span class="mf">0.3094</span><span class="p">,</span> <span class="mf">0.0274</span><span class="p">,</span> <span class="mf">0.368</span><span class="p">,</span> <span class="mf">17.0355</span><span class="p">,</span> <span class="mf">0.6559</span><span class="p">,</span> <span class="mf">6.5236</span><span class="p">,</span> <span class="mf">0.2856</span><span class="p">],</span>
                  <span class="s1">&#39;Cr4&#39;</span><span class="p">:</span> <span class="p">[</span><span class="o">-</span><span class="mf">0.232</span><span class="p">,</span> <span class="mf">0.0433</span><span class="p">,</span> <span class="mf">0.3101</span><span class="p">,</span> <span class="mf">14.9518</span><span class="p">,</span> <span class="mf">0.7182</span><span class="p">,</span> <span class="mf">6.1726</span><span class="p">,</span> <span class="mf">0.2042</span><span class="p">],</span>
                  <span class="s1">&#39;Cu0&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.0909</span><span class="p">,</span> <span class="mf">34.9838</span><span class="p">,</span> <span class="mf">0.4088</span><span class="p">,</span> <span class="mf">11.4432</span><span class="p">,</span> <span class="mf">0.5128</span><span class="p">,</span> <span class="mf">3.8248</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0124</span><span class="p">],</span>
                  <span class="s1">&#39;Cu1&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.0749</span><span class="p">,</span> <span class="mf">34.9656</span><span class="p">,</span> <span class="mf">0.4147</span><span class="p">,</span> <span class="mf">11.7642</span><span class="p">,</span> <span class="mf">0.5238</span><span class="p">,</span> <span class="mf">3.8497</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0127</span><span class="p">],</span>
                  <span class="s1">&#39;Cu2&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.0232</span><span class="p">,</span> <span class="mf">34.9686</span><span class="p">,</span> <span class="mf">0.4023</span><span class="p">,</span> <span class="mf">11.564</span><span class="p">,</span> <span class="mf">0.5882</span><span class="p">,</span> <span class="mf">3.8428</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0137</span><span class="p">],</span>
                  <span class="s1">&#39;Cu3&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.0031</span><span class="p">,</span> <span class="mf">34.9074</span><span class="p">,</span> <span class="mf">0.3582</span><span class="p">,</span> <span class="mf">10.9138</span><span class="p">,</span> <span class="mf">0.6531</span><span class="p">,</span> <span class="mf">3.8279</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0147</span><span class="p">],</span>
                  <span class="s1">&#39;Cu4&#39;</span><span class="p">:</span> <span class="p">[</span><span class="o">-</span><span class="mf">0.0132</span><span class="p">,</span> <span class="mf">30.6817</span><span class="p">,</span> <span class="mf">0.2801</span><span class="p">,</span> <span class="mf">11.1626</span><span class="p">,</span> <span class="mf">0.749</span><span class="p">,</span> <span class="mf">3.8172</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0165</span><span class="p">],</span>
                  <span class="s1">&#39;Dy2&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.1308</span><span class="p">,</span> <span class="mf">18.3155</span><span class="p">,</span> <span class="mf">0.3118</span><span class="p">,</span> <span class="mf">7.6645</span><span class="p">,</span> <span class="mf">0.5795</span><span class="p">,</span> <span class="mf">3.1469</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0226</span><span class="p">],</span>
                  <span class="s1">&#39;Dy3&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.1157</span><span class="p">,</span> <span class="mf">15.0732</span><span class="p">,</span> <span class="mf">0.327</span><span class="p">,</span> <span class="mf">6.7991</span><span class="p">,</span> <span class="mf">0.5821</span><span class="p">,</span> <span class="mf">3.0202</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0249</span><span class="p">],</span>
                  <span class="s1">&#39;Er2&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.1122</span><span class="p">,</span> <span class="mf">18.1223</span><span class="p">,</span> <span class="mf">0.3462</span><span class="p">,</span> <span class="mf">6.9106</span><span class="p">,</span> <span class="mf">0.5649</span><span class="p">,</span> <span class="mf">2.7614</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0235</span><span class="p">],</span>
                  <span class="s1">&#39;Er3&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.0586</span><span class="p">,</span> <span class="mf">17.9802</span><span class="p">,</span> <span class="mf">0.354</span><span class="p">,</span> <span class="mf">7.0964</span><span class="p">,</span> <span class="mf">0.6126</span><span class="p">,</span> <span class="mf">2.7482</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0251</span><span class="p">],</span>
                  <span class="s1">&#39;Eu2&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.0755</span><span class="p">,</span> <span class="mf">25.296</span><span class="p">,</span> <span class="mf">0.3001</span><span class="p">,</span> <span class="mf">11.5993</span><span class="p">,</span> <span class="mf">0.6438</span><span class="p">,</span> <span class="mf">4.0252</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0196</span><span class="p">],</span>
                  <span class="s1">&#39;Eu3&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.0204</span><span class="p">,</span> <span class="mf">25.3078</span><span class="p">,</span> <span class="mf">0.301</span><span class="p">,</span> <span class="mf">11.4744</span><span class="p">,</span> <span class="mf">0.7005</span><span class="p">,</span> <span class="mf">3.942</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.022</span><span class="p">],</span>
                  <span class="s1">&#39;Fe0&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.0706</span><span class="p">,</span> <span class="mf">35.0085</span><span class="p">,</span> <span class="mf">0.3589</span><span class="p">,</span> <span class="mf">15.3583</span><span class="p">,</span> <span class="mf">0.5819</span><span class="p">,</span> <span class="mf">5.5606</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0114</span><span class="p">],</span>
                  <span class="s1">&#39;Fe1&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.1251</span><span class="p">,</span> <span class="mf">34.9633</span><span class="p">,</span> <span class="mf">0.3629</span><span class="p">,</span> <span class="mf">15.5144</span><span class="p">,</span> <span class="mf">0.5223</span><span class="p">,</span> <span class="mf">5.5914</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0105</span><span class="p">],</span>
                  <span class="s1">&#39;Fe2&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.0263</span><span class="p">,</span> <span class="mf">34.9597</span><span class="p">,</span> <span class="mf">0.3668</span><span class="p">,</span> <span class="mf">15.9435</span><span class="p">,</span> <span class="mf">0.6188</span><span class="p">,</span> <span class="mf">5.5935</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0119</span><span class="p">],</span>
                  <span class="s1">&#39;Fe3&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.3972</span><span class="p">,</span> <span class="mf">13.2442</span><span class="p">,</span> <span class="mf">0.6295</span><span class="p">,</span> <span class="mf">4.9034</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0314</span><span class="p">,</span> <span class="mf">0.3496</span><span class="p">,</span> <span class="mf">0.0044</span><span class="p">],</span>
                  <span class="s1">&#39;Fe4&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.3782</span><span class="p">,</span> <span class="mf">11.38</span><span class="p">,</span> <span class="mf">0.6556</span><span class="p">,</span> <span class="mf">4.592</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0346</span><span class="p">,</span> <span class="mf">0.4833</span><span class="p">,</span> <span class="mf">0.0005</span><span class="p">],</span>
                  <span class="s1">&#39;Gd2&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.0636</span><span class="p">,</span> <span class="mf">25.3823</span><span class="p">,</span> <span class="mf">0.3033</span><span class="p">,</span> <span class="mf">11.2125</span><span class="p">,</span> <span class="mf">0.6528</span><span class="p">,</span> <span class="mf">3.7877</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0199</span><span class="p">],</span>
                  <span class="s1">&#39;Gd3&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.0186</span><span class="p">,</span> <span class="mf">25.3867</span><span class="p">,</span> <span class="mf">0.2895</span><span class="p">,</span> <span class="mf">11.1421</span><span class="p">,</span> <span class="mf">0.7135</span><span class="p">,</span> <span class="mf">3.752</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0217</span><span class="p">],</span>
                  <span class="s1">&#39;Ho2&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.0995</span><span class="p">,</span> <span class="mf">18.1761</span><span class="p">,</span> <span class="mf">0.3305</span><span class="p">,</span> <span class="mf">7.8556</span><span class="p">,</span> <span class="mf">0.5921</span><span class="p">,</span> <span class="mf">2.9799</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.023</span><span class="p">],</span>
                  <span class="s1">&#39;Ho3&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.0566</span><span class="p">,</span> <span class="mf">18.3176</span><span class="p">,</span> <span class="mf">0.3365</span><span class="p">,</span> <span class="mf">7.688</span><span class="p">,</span> <span class="mf">0.6317</span><span class="p">,</span> <span class="mf">2.9427</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0248</span><span class="p">],</span>
                  <span class="s1">&#39;Mn0&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.2438</span><span class="p">,</span> <span class="mf">24.9629</span><span class="p">,</span> <span class="mf">0.1472</span><span class="p">,</span> <span class="mf">15.6728</span><span class="p">,</span> <span class="mf">0.6189</span><span class="p">,</span> <span class="mf">6.5403</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0105</span><span class="p">],</span>
                  <span class="s1">&#39;Mn1&#39;</span><span class="p">:</span> <span class="p">[</span><span class="o">-</span><span class="mf">0.0138</span><span class="p">,</span> <span class="mf">0.4213</span><span class="p">,</span> <span class="mf">0.4231</span><span class="p">,</span> <span class="mf">24.668</span><span class="p">,</span> <span class="mf">0.5905</span><span class="p">,</span> <span class="mf">6.6545</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.001</span><span class="p">],</span>
                  <span class="s1">&#39;Mn2&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.422</span><span class="p">,</span> <span class="mf">17.684</span><span class="p">,</span> <span class="mf">0.5948</span><span class="p">,</span> <span class="mf">6.005</span><span class="p">,</span> <span class="mf">0.0043</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.609</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0219</span><span class="p">],</span>
                  <span class="s1">&#39;Mn3&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.4198</span><span class="p">,</span> <span class="mf">14.2829</span><span class="p">,</span> <span class="mf">0.6054</span><span class="p">,</span> <span class="mf">5.4689</span><span class="p">,</span> <span class="mf">0.9241</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0088</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.9498</span><span class="p">],</span>
                  <span class="s1">&#39;Mn4&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.376</span><span class="p">,</span> <span class="mf">12.5661</span><span class="p">,</span> <span class="mf">0.6602</span><span class="p">,</span> <span class="mf">5.1329</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0372</span><span class="p">,</span> <span class="mf">0.563</span><span class="p">,</span> <span class="mf">0.0011</span><span class="p">],</span>
                  <span class="s1">&#39;Mo0&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.1806</span><span class="p">,</span> <span class="mf">49.0568</span><span class="p">,</span> <span class="mf">1.2306</span><span class="p">,</span> <span class="mf">14.7859</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.4268</span><span class="p">,</span> <span class="mf">6.9866</span><span class="p">,</span> <span class="mf">0.0171</span><span class="p">],</span>
                  <span class="s1">&#39;Mo1&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.35</span><span class="p">,</span> <span class="mf">48.0354</span><span class="p">,</span> <span class="mf">1.0305</span><span class="p">,</span> <span class="mf">15.0604</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.3929</span><span class="p">,</span> <span class="mf">7.479</span><span class="p">,</span> <span class="mf">0.0139</span><span class="p">],</span>
                  <span class="s1">&#39;Nb0&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.3946</span><span class="p">,</span> <span class="mf">49.2297</span><span class="p">,</span> <span class="mf">1.3197</span><span class="p">,</span> <span class="mf">14.8216</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.7269</span><span class="p">,</span> <span class="mf">9.6156</span><span class="p">,</span> <span class="mf">0.0129</span><span class="p">],</span>
                  <span class="s1">&#39;Nb1&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.4572</span><span class="p">,</span> <span class="mf">49.9182</span><span class="p">,</span> <span class="mf">1.0274</span><span class="p">,</span> <span class="mf">15.7256</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.4962</span><span class="p">,</span> <span class="mf">9.1573</span><span class="p">,</span> <span class="mf">0.0118</span><span class="p">],</span>
                  <span class="s1">&#39;Nd2&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.1645</span><span class="p">,</span> <span class="mf">25.0453</span><span class="p">,</span> <span class="mf">0.2522</span><span class="p">,</span> <span class="mf">11.9782</span><span class="p">,</span> <span class="mf">0.6012</span><span class="p">,</span> <span class="mf">4.9461</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.018</span><span class="p">],</span>
                  <span class="s1">&#39;Nd3&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.054</span><span class="p">,</span> <span class="mf">25.0293</span><span class="p">,</span> <span class="mf">0.3101</span><span class="p">,</span> <span class="mf">12.102</span><span class="p">,</span> <span class="mf">0.6575</span><span class="p">,</span> <span class="mf">4.7223</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0216</span><span class="p">],</span>
                  <span class="s1">&#39;Ni0&#39;</span><span class="p">:</span> <span class="p">[</span><span class="o">-</span><span class="mf">0.0172</span><span class="p">,</span> <span class="mf">35.7392</span><span class="p">,</span> <span class="mf">0.3174</span><span class="p">,</span> <span class="mf">14.2689</span><span class="p">,</span> <span class="mf">0.7136</span><span class="p">,</span> <span class="mf">4.5661</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0143</span><span class="p">],</span>
                  <span class="s1">&#39;Ni1&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.0705</span><span class="p">,</span> <span class="mf">35.8561</span><span class="p">,</span> <span class="mf">0.3984</span><span class="p">,</span> <span class="mf">13.8042</span><span class="p">,</span> <span class="mf">0.5427</span><span class="p">,</span> <span class="mf">4.3965</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0118</span><span class="p">],</span>
                  <span class="s1">&#39;Ni2&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.0163</span><span class="p">,</span> <span class="mf">35.8826</span><span class="p">,</span> <span class="mf">0.3916</span><span class="p">,</span> <span class="mf">13.2233</span><span class="p">,</span> <span class="mf">0.6052</span><span class="p">,</span> <span class="mf">4.3388</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0133</span><span class="p">],</span>
                  <span class="s1">&#39;Ni3&#39;</span><span class="p">:</span> <span class="p">[</span><span class="o">-</span><span class="mf">0.0134</span><span class="p">,</span> <span class="mf">35.8677</span><span class="p">,</span> <span class="mf">0.2678</span><span class="p">,</span> <span class="mf">12.3326</span><span class="p">,</span> <span class="mf">0.7614</span><span class="p">,</span> <span class="mf">4.2369</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0162</span><span class="p">],</span>
                  <span class="s1">&#39;Ni4&#39;</span><span class="p">:</span> <span class="p">[</span><span class="o">-</span><span class="mf">0.009</span><span class="p">,</span> <span class="mf">35.8614</span><span class="p">,</span> <span class="mf">0.2776</span><span class="p">,</span> <span class="mf">11.7904</span><span class="p">,</span> <span class="mf">0.7474</span><span class="p">,</span> <span class="mf">4.2011</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0163</span><span class="p">],</span>
                  <span class="s1">&#39;Np3&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.5157</span><span class="p">,</span> <span class="mf">20.8654</span><span class="p">,</span> <span class="mf">2.2784</span><span class="p">,</span> <span class="mf">5.893</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.8163</span><span class="p">,</span> <span class="mf">4.8457</span><span class="p">,</span> <span class="mf">0.0211</span><span class="p">],</span>
                  <span class="s1">&#39;Np4&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.4206</span><span class="p">,</span> <span class="mf">19.8046</span><span class="p">,</span> <span class="mf">2.8004</span><span class="p">,</span> <span class="mf">5.9783</span><span class="p">,</span> <span class="o">-</span><span class="mf">2.2436</span><span class="p">,</span> <span class="mf">4.9848</span><span class="p">,</span> <span class="mf">0.0228</span><span class="p">],</span>
                  <span class="s1">&#39;Np5&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.3692</span><span class="p">,</span> <span class="mf">18.19</span><span class="p">,</span> <span class="mf">3.151</span><span class="p">,</span> <span class="mf">5.85</span><span class="p">,</span> <span class="o">-</span><span class="mf">2.5446</span><span class="p">,</span> <span class="mf">4.9164</span><span class="p">,</span> <span class="mf">0.0248</span><span class="p">],</span>
                  <span class="s1">&#39;Np6&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.2929</span><span class="p">,</span> <span class="mf">17.5611</span><span class="p">,</span> <span class="mf">3.4866</span><span class="p">,</span> <span class="mf">5.7847</span><span class="p">,</span> <span class="o">-</span><span class="mf">2.8066</span><span class="p">,</span> <span class="mf">4.8707</span><span class="p">,</span> <span class="mf">0.0267</span><span class="p">],</span>
                  <span class="s1">&#39;Pd0&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.2003</span><span class="p">,</span> <span class="mf">29.3633</span><span class="p">,</span> <span class="mf">1.1446</span><span class="p">,</span> <span class="mf">9.5993</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.3689</span><span class="p">,</span> <span class="mf">4.0423</span><span class="p">,</span> <span class="mf">0.0251</span><span class="p">],</span>
                  <span class="s1">&#39;Pd1&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.5033</span><span class="p">,</span> <span class="mf">24.5037</span><span class="p">,</span> <span class="mf">1.9982</span><span class="p">,</span> <span class="mf">6.9082</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.524</span><span class="p">,</span> <span class="mf">5.5133</span><span class="p">,</span> <span class="mf">0.0213</span><span class="p">],</span>
                  <span class="s1">&#39;Pr3&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.0504</span><span class="p">,</span> <span class="mf">24.9989</span><span class="p">,</span> <span class="mf">0.2572</span><span class="p">,</span> <span class="mf">12.0377</span><span class="p">,</span> <span class="mf">0.7142</span><span class="p">,</span> <span class="mf">5.0039</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0219</span><span class="p">],</span>
                  <span class="s1">&#39;Pu3&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.384</span><span class="p">,</span> <span class="mf">16.6793</span><span class="p">,</span> <span class="mf">3.1049</span><span class="p">,</span> <span class="mf">5.421</span><span class="p">,</span> <span class="o">-</span><span class="mf">2.5148</span><span class="p">,</span> <span class="mf">4.5512</span><span class="p">,</span> <span class="mf">0.0263</span><span class="p">],</span>
                  <span class="s1">&#39;Pu4&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.4934</span><span class="p">,</span> <span class="mf">16.8355</span><span class="p">,</span> <span class="mf">1.6394</span><span class="p">,</span> <span class="mf">5.6384</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.1581</span><span class="p">,</span> <span class="mf">4.1399</span><span class="p">,</span> <span class="mf">0.0248</span><span class="p">],</span>
                  <span class="s1">&#39;Pu5&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.3888</span><span class="p">,</span> <span class="mf">16.5592</span><span class="p">,</span> <span class="mf">2.0362</span><span class="p">,</span> <span class="mf">5.6567</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.4515</span><span class="p">,</span> <span class="mf">4.2552</span><span class="p">,</span> <span class="mf">0.0267</span><span class="p">],</span>
                  <span class="s1">&#39;Pu6&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.3172</span><span class="p">,</span> <span class="mf">16.0507</span><span class="p">,</span> <span class="mf">3.4654</span><span class="p">,</span> <span class="mf">5.3507</span><span class="p">,</span> <span class="o">-</span><span class="mf">2.8102</span><span class="p">,</span> <span class="mf">4.5133</span><span class="p">,</span> <span class="mf">0.0281</span><span class="p">],</span>
                  <span class="s1">&#39;Rh0&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.0976</span><span class="p">,</span> <span class="mf">49.8825</span><span class="p">,</span> <span class="mf">1.1601</span><span class="p">,</span> <span class="mf">11.8307</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.2789</span><span class="p">,</span> <span class="mf">4.1266</span><span class="p">,</span> <span class="mf">0.0234</span><span class="p">],</span>
                  <span class="s1">&#39;Rh1&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.3342</span><span class="p">,</span> <span class="mf">29.7564</span><span class="p">,</span> <span class="mf">1.2209</span><span class="p">,</span> <span class="mf">9.4384</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5755</span><span class="p">,</span> <span class="mf">5.332</span><span class="p">,</span> <span class="mf">0.021</span><span class="p">],</span>
                  <span class="s1">&#39;Ru0&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.1069</span><span class="p">,</span> <span class="mf">49.4238</span><span class="p">,</span> <span class="mf">1.1912</span><span class="p">,</span> <span class="mf">12.7417</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.3176</span><span class="p">,</span> <span class="mf">4.9125</span><span class="p">,</span> <span class="mf">0.0213</span><span class="p">],</span>
                  <span class="s1">&#39;Ru1&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.441</span><span class="p">,</span> <span class="mf">33.3086</span><span class="p">,</span> <span class="mf">1.4775</span><span class="p">,</span> <span class="mf">9.5531</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.9361</span><span class="p">,</span> <span class="mf">6.722</span><span class="p">,</span> <span class="mf">0.0176</span><span class="p">],</span>
                  <span class="s1">&#39;Sc0&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.2512</span><span class="p">,</span> <span class="mf">90.0296</span><span class="p">,</span> <span class="mf">0.329</span><span class="p">,</span> <span class="mf">39.4021</span><span class="p">,</span> <span class="mf">0.4235</span><span class="p">,</span> <span class="mf">14.3222</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0043</span><span class="p">],</span>
                  <span class="s1">&#39;Sc1&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.4889</span><span class="p">,</span> <span class="mf">51.1603</span><span class="p">,</span> <span class="mf">0.5203</span><span class="p">,</span> <span class="mf">14.0764</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0286</span><span class="p">,</span> <span class="mf">0.1792</span><span class="p">,</span> <span class="mf">0.0185</span><span class="p">],</span>
                  <span class="s1">&#39;Sc2&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.5048</span><span class="p">,</span> <span class="mf">31.4035</span><span class="p">,</span> <span class="mf">0.5186</span><span class="p">,</span> <span class="mf">10.9897</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0241</span><span class="p">,</span> <span class="mf">1.1831</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">],</span>
                  <span class="s1">&#39;Sm2&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.0909</span><span class="p">,</span> <span class="mf">25.2032</span><span class="p">,</span> <span class="mf">0.3037</span><span class="p">,</span> <span class="mf">11.8562</span><span class="p">,</span> <span class="mf">0.625</span><span class="p">,</span> <span class="mf">4.2366</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.02</span><span class="p">],</span>
                  <span class="s1">&#39;Sm3&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.0288</span><span class="p">,</span> <span class="mf">25.2068</span><span class="p">,</span> <span class="mf">0.2973</span><span class="p">,</span> <span class="mf">11.8311</span><span class="p">,</span> <span class="mf">0.6954</span><span class="p">,</span> <span class="mf">4.2117</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0213</span><span class="p">],</span>
                  <span class="s1">&#39;Tb2&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.0547</span><span class="p">,</span> <span class="mf">25.5086</span><span class="p">,</span> <span class="mf">0.3171</span><span class="p">,</span> <span class="mf">10.5911</span><span class="p">,</span> <span class="mf">0.649</span><span class="p">,</span> <span class="mf">3.5171</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0212</span><span class="p">],</span>
                  <span class="s1">&#39;Tb3&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.0177</span><span class="p">,</span> <span class="mf">25.5095</span><span class="p">,</span> <span class="mf">0.2921</span><span class="p">,</span> <span class="mf">10.5769</span><span class="p">,</span> <span class="mf">0.7133</span><span class="p">,</span> <span class="mf">3.5122</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0231</span><span class="p">],</span>
                  <span class="s1">&#39;Tc0&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.1298</span><span class="p">,</span> <span class="mf">49.6611</span><span class="p">,</span> <span class="mf">1.1656</span><span class="p">,</span> <span class="mf">14.1307</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.3134</span><span class="p">,</span> <span class="mf">5.5129</span><span class="p">,</span> <span class="mf">0.0195</span><span class="p">],</span>
                  <span class="s1">&#39;Tc1&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.2674</span><span class="p">,</span> <span class="mf">48.9566</span><span class="p">,</span> <span class="mf">0.9569</span><span class="p">,</span> <span class="mf">15.1413</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.2387</span><span class="p">,</span> <span class="mf">5.4578</span><span class="p">,</span> <span class="mf">0.016</span><span class="p">],</span>
                  <span class="s1">&#39;Ti0&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.4657</span><span class="p">,</span> <span class="mf">33.5898</span><span class="p">,</span> <span class="mf">0.549</span><span class="p">,</span> <span class="mf">9.8791</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0291</span><span class="p">,</span> <span class="mf">0.3232</span><span class="p">,</span> <span class="mf">0.0123</span><span class="p">],</span>
                  <span class="s1">&#39;Ti1&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.5093</span><span class="p">,</span> <span class="mf">36.7033</span><span class="p">,</span> <span class="mf">0.5032</span><span class="p">,</span> <span class="mf">10.3713</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0263</span><span class="p">,</span> <span class="mf">0.3106</span><span class="p">,</span> <span class="mf">0.0116</span><span class="p">],</span>
                  <span class="s1">&#39;Ti2&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.5091</span><span class="p">,</span> <span class="mf">24.9763</span><span class="p">,</span> <span class="mf">0.5162</span><span class="p">,</span> <span class="mf">8.7569</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0281</span><span class="p">,</span> <span class="mf">0.916</span><span class="p">,</span> <span class="mf">0.0015</span><span class="p">],</span>
                  <span class="s1">&#39;Ti3&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.3571</span><span class="p">,</span> <span class="mf">22.8413</span><span class="p">,</span> <span class="mf">0.6688</span><span class="p">,</span> <span class="mf">8.9306</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0354</span><span class="p">,</span> <span class="mf">0.4833</span><span class="p">,</span> <span class="mf">0.0099</span><span class="p">],</span>
                  <span class="s1">&#39;Tm2&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.0983</span><span class="p">,</span> <span class="mf">18.3236</span><span class="p">,</span> <span class="mf">0.338</span><span class="p">,</span> <span class="mf">6.9178</span><span class="p">,</span> <span class="mf">0.5875</span><span class="p">,</span> <span class="mf">2.6622</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0241</span><span class="p">],</span>
                  <span class="s1">&#39;Tm3&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.0581</span><span class="p">,</span> <span class="mf">15.0922</span><span class="p">,</span> <span class="mf">0.2787</span><span class="p">,</span> <span class="mf">7.8015</span><span class="p">,</span> <span class="mf">0.6854</span><span class="p">,</span> <span class="mf">2.7931</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0224</span><span class="p">],</span>
                  <span class="s1">&#39;U3&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.5058</span><span class="p">,</span> <span class="mf">23.2882</span><span class="p">,</span> <span class="mf">1.3464</span><span class="p">,</span> <span class="mf">7.0028</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.8724</span><span class="p">,</span> <span class="mf">4.8683</span><span class="p">,</span> <span class="mf">0.0192</span><span class="p">],</span>
                  <span class="s1">&#39;U4&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.3291</span><span class="p">,</span> <span class="mf">23.5475</span><span class="p">,</span> <span class="mf">1.0836</span><span class="p">,</span> <span class="mf">8.454</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.434</span><span class="p">,</span> <span class="mf">4.1196</span><span class="p">,</span> <span class="mf">0.0214</span><span class="p">],</span>
                  <span class="s1">&#39;U5&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.365</span><span class="p">,</span> <span class="mf">19.8038</span><span class="p">,</span> <span class="mf">3.2199</span><span class="p">,</span> <span class="mf">6.2818</span><span class="p">,</span> <span class="o">-</span><span class="mf">2.6077</span><span class="p">,</span> <span class="mf">5.301</span><span class="p">,</span> <span class="mf">0.0233</span><span class="p">],</span>
                  <span class="s1">&#39;V0&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.4086</span><span class="p">,</span> <span class="mf">28.8109</span><span class="p">,</span> <span class="mf">0.6077</span><span class="p">,</span> <span class="mf">8.5437</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0295</span><span class="p">,</span> <span class="mf">0.2768</span><span class="p">,</span> <span class="mf">0.0123</span><span class="p">],</span>
                  <span class="s1">&#39;V1&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.4444</span><span class="p">,</span> <span class="mf">32.6479</span><span class="p">,</span> <span class="mf">0.5683</span><span class="p">,</span> <span class="mf">9.0971</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.2285</span><span class="p">,</span> <span class="mf">0.0218</span><span class="p">,</span> <span class="mf">0.215</span><span class="p">],</span>
                  <span class="s1">&#39;V2&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.4085</span><span class="p">,</span> <span class="mf">23.8526</span><span class="p">,</span> <span class="mf">0.6091</span><span class="p">,</span> <span class="mf">8.2456</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.1676</span><span class="p">,</span> <span class="mf">0.0415</span><span class="p">,</span> <span class="mf">0.1496</span><span class="p">],</span>
                  <span class="s1">&#39;V3&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.3598</span><span class="p">,</span> <span class="mf">19.3364</span><span class="p">,</span> <span class="mf">0.6632</span><span class="p">,</span> <span class="mf">7.6172</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.3064</span><span class="p">,</span> <span class="mf">0.0296</span><span class="p">,</span> <span class="mf">0.2835</span><span class="p">],</span>
                  <span class="s1">&#39;V4&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.3106</span><span class="p">,</span> <span class="mf">16.816</span><span class="p">,</span> <span class="mf">0.7198</span><span class="p">,</span> <span class="mf">7.0487</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0521</span><span class="p">,</span> <span class="mf">0.302</span><span class="p">,</span> <span class="mf">0.0221</span><span class="p">],</span>
                  <span class="s1">&#39;Y0&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.5915</span><span class="p">,</span> <span class="mf">67.6081</span><span class="p">,</span> <span class="mf">1.5123</span><span class="p">,</span> <span class="mf">17.9004</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.113</span><span class="p">,</span> <span class="mf">14.1359</span><span class="p">,</span> <span class="mf">0.008</span><span class="p">],</span>
                  <span class="s1">&#39;Yb2&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.0855</span><span class="p">,</span> <span class="mf">18.5123</span><span class="p">,</span> <span class="mf">0.2943</span><span class="p">,</span> <span class="mf">7.3734</span><span class="p">,</span> <span class="mf">0.6412</span><span class="p">,</span> <span class="mf">2.6777</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0213</span><span class="p">],</span>
                  <span class="s1">&#39;Yb3&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.0416</span><span class="p">,</span> <span class="mf">16.0949</span><span class="p">,</span> <span class="mf">0.2849</span><span class="p">,</span> <span class="mf">7.8341</span><span class="p">,</span> <span class="mf">0.6961</span><span class="p">,</span> <span class="mf">2.6725</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0229</span><span class="p">],</span>
                  <span class="s1">&#39;Zr0&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.4106</span><span class="p">,</span> <span class="mf">59.9961</span><span class="p">,</span> <span class="mf">1.0543</span><span class="p">,</span> <span class="mf">18.6476</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.4751</span><span class="p">,</span> <span class="mf">10.54</span><span class="p">,</span> <span class="mf">0.0106</span><span class="p">],</span>
                  <span class="s1">&#39;Zr1&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.4532</span><span class="p">,</span> <span class="mf">59.5948</span><span class="p">,</span> <span class="mf">0.7834</span><span class="p">,</span> <span class="mf">21.4357</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.2451</span><span class="p">,</span> <span class="mf">9.036</span><span class="p">,</span> <span class="mf">0.0098</span><span class="p">]}</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">j2dict</span><span class="p">[</span><span class="n">name</span><span class="p">]</span>
        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
            <span class="k">print</span> <span class="s1">&#39;No magnetic form factor found for that element/ion.&#39;</span>
            <span class="k">return</span> <span class="p">[</span><span class="s1">&#39;none&#39;</span><span class="p">]</span></div>

<div class="viewcode-block" id="spinsFromAtoms"><a class="viewcode-back" href="../../../source/diffpy.mpdf.html#diffpy.mpdf.magstructure.spinsFromAtoms">[docs]</a><span class="k">def</span> <span class="nf">spinsFromAtoms</span><span class="p">(</span><span class="n">magstruc</span><span class="p">,</span><span class="n">positions</span><span class="p">,</span><span class="n">fractional</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span><span class="n">returnIdxs</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Return the spin vectors corresponding to specified atomic</span>
<span class="sd">       positions.</span>

<span class="sd">    Args:</span>
<span class="sd">        magstruc: MagSpecies or MagStructure object containing atoms and spins</span>
<span class="sd">        positions (list or array): atomic positions for which the</span>
<span class="sd">            corresponding spins should be returned.</span>
<span class="sd">        fractional (boolean): set as True if the atomic positions are in</span>
<span class="sd">            fractional coordinates of the crystallographic lattice</span>
<span class="sd">            vectors.</span>
<span class="sd">        returnIdxs (boolean): if True, the indices of the spins will also be</span>
<span class="sd">            returned.</span>
<span class="sd">    Returns:</span>
<span class="sd">        Array consisting of the spins corresponding to the atomic positions.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">positions</span><span class="p">)</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">positions</span> <span class="o">=</span> <span class="p">[</span><span class="n">positions</span><span class="p">]</span>        
    <span class="n">spins</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">idxs</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">badlist</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">pos</span> <span class="ow">in</span> <span class="n">positions</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">fractional</span><span class="p">:</span>
            <span class="n">pos</span><span class="o">=</span><span class="n">magstruc</span><span class="o">.</span><span class="n">struc</span><span class="o">.</span><span class="n">lattice</span><span class="o">.</span><span class="n">cartesian</span><span class="p">(</span><span class="n">pos</span><span class="p">)</span>
        <span class="n">mask</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">magstruc</span><span class="o">.</span><span class="n">atoms</span><span class="p">,</span><span class="n">decimals</span><span class="o">=</span><span class="mi">6</span><span class="p">)</span><span class="o">==</span>
                      <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">pos</span><span class="p">,</span><span class="n">decimals</span><span class="o">=</span><span class="mi">6</span><span class="p">),</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">goodspins</span> <span class="o">=</span> <span class="n">magstruc</span><span class="o">.</span><span class="n">spins</span><span class="p">[</span><span class="n">mask</span><span class="p">]</span>
        <span class="n">goodidxs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">mask</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">goodspins</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">spins</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">goodspins</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
            <span class="n">idxs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">goodidxs</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">goodspins</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>        
            <span class="k">print</span> <span class="s1">&#39;Warning: duplicate atoms in structure&#39;</span>
            <span class="n">spins</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">goodspins</span><span class="p">)</span>
            <span class="n">idxs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">goodidxs</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">goodspins</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">spins</span><span class="o">.</span><span class="n">append</span><span class="p">([])</span>
            <span class="n">idxs</span><span class="o">.</span><span class="n">append</span><span class="p">([])</span>
            <span class="n">badlist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pos</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">badlist</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">print</span> <span class="s1">&#39;The following atomic positions do not correspond to a spin:&#39;</span>
        <span class="k">for</span> <span class="n">bad</span> <span class="ow">in</span> <span class="n">badlist</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">fractional</span><span class="p">:</span>
                <span class="n">bad</span><span class="o">=</span><span class="n">magstruc</span><span class="o">.</span><span class="n">struc</span><span class="o">.</span><span class="n">lattice</span><span class="o">.</span><span class="n">fractional</span><span class="p">(</span><span class="n">pos</span><span class="p">)</span>
            <span class="k">print</span> <span class="n">bad</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">returnIdxs</span><span class="p">:</span>    
        <span class="k">return</span> <span class="n">spins</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">spins</span><span class="p">,</span><span class="n">idxs</span></div>

<div class="viewcode-block" id="atomsFromSpins"><a class="viewcode-back" href="../../../source/diffpy.mpdf.html#diffpy.mpdf.magstructure.atomsFromSpins">[docs]</a><span class="k">def</span> <span class="nf">atomsFromSpins</span><span class="p">(</span><span class="n">magstruc</span><span class="p">,</span><span class="n">spinvecs</span><span class="p">,</span><span class="n">fractional</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span><span class="n">returnIdxs</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Return the atomic positions corresponding to specified spins.</span>

<span class="sd">    Args:</span>
<span class="sd">        magstruc: MagSpecies or MagStructure object containing atoms and spins</span>
<span class="sd">        spinvecs (list or array): spin vectors for which the</span>
<span class="sd">            corresponding atoms should be returned.</span>
<span class="sd">        fractional (boolean): set as True if the atomic positions are to be</span>
<span class="sd">            returned as fractional coordinates of the crystallographic lattice</span>
<span class="sd">            vectors.</span>
<span class="sd">        returnIdxs (boolean): if True, the indices of the atoms will also be</span>
<span class="sd">            returned.</span>

<span class="sd">    Returns:</span>
<span class="sd">        List of arrays of atoms corresponding to the spins.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">spinvecs</span><span class="p">)</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">spinvecs</span> <span class="o">=</span> <span class="p">[</span><span class="n">spinvecs</span><span class="p">]</span>        
    <span class="n">atoms</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">idxs</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">badlist</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">spin</span> <span class="ow">in</span> <span class="n">spinvecs</span><span class="p">:</span>
        <span class="n">mask</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">magstruc</span><span class="o">.</span><span class="n">spins</span><span class="p">,</span><span class="n">decimals</span><span class="o">=</span><span class="mi">6</span><span class="p">)</span><span class="o">==</span>
                      <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">spin</span><span class="p">,</span><span class="n">decimals</span><span class="o">=</span><span class="mi">6</span><span class="p">),</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">goodatoms</span> <span class="o">=</span> <span class="n">magstruc</span><span class="o">.</span><span class="n">atoms</span><span class="p">[</span><span class="n">mask</span><span class="p">]</span>
        <span class="n">goodidxs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">mask</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">fractional</span><span class="p">:</span>
            <span class="n">goodatoms</span><span class="o">=</span><span class="n">magstruc</span><span class="o">.</span><span class="n">struc</span><span class="o">.</span><span class="n">lattice</span><span class="o">.</span><span class="n">fractional</span><span class="p">(</span><span class="n">goodatoms</span><span class="p">)</span>
        <span class="n">atoms</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">goodatoms</span><span class="p">)</span>
        <span class="n">idxs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">goodidxs</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">goodidxs</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">badlist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">spin</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">badlist</span><span class="p">)</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">:</span>
        <span class="k">print</span> <span class="s1">&#39;The following spins were not found in the structure:&#39;</span>
        <span class="k">for</span> <span class="n">bad</span> <span class="ow">in</span> <span class="n">badlist</span><span class="p">:</span>
            <span class="k">print</span> <span class="n">bad</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">returnIdxs</span><span class="p">:</span>    
        <span class="k">return</span> <span class="n">atoms</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">atoms</span><span class="p">,</span><span class="n">idxs</span></div>

<div class="viewcode-block" id="visualizeSpins"><a class="viewcode-back" href="../../../source/diffpy.mpdf.html#diffpy.mpdf.magstructure.visualizeSpins">[docs]</a><span class="k">def</span> <span class="nf">visualizeSpins</span><span class="p">(</span><span class="n">atoms</span><span class="p">,</span><span class="n">spins</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Set up a 3d plot showing an arrangement of spins.</span>

<span class="sd">    Args:</span>
<span class="sd">        atoms (numpy array): array of atomic positions of spins to be</span>
<span class="sd">            visualized.</span>
<span class="sd">        spins (numpy array): array of spin vectors in same order as atoms.</span>

<span class="sd">    Returns:</span>
<span class="sd">        matplotlib figure object with a quiver plot on 3d axes.        </span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="kn">as</span> <span class="nn">plt</span>
    <span class="kn">from</span> <span class="nn">mpl_toolkits.mplot3d</span> <span class="kn">import</span> <span class="n">axes3d</span>

    <span class="n">xx</span><span class="p">,</span><span class="n">yy</span><span class="p">,</span><span class="n">zz</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="n">atoms</span><span class="p">)</span>
    <span class="n">uu</span><span class="p">,</span><span class="n">vv</span><span class="p">,</span><span class="n">ww</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="n">spins</span><span class="p">)</span>
    
    <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">,</span> <span class="n">projection</span><span class="o">=</span><span class="s1">&#39;3d&#39;</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">xx</span><span class="p">)):</span>
        <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">w</span> <span class="o">=</span> <span class="n">xx</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">yy</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">zz</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">uu</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">vv</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">ww</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
        <span class="n">mag</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">u</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">v</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">w</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">quiver</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">w</span><span class="p">,</span> <span class="n">pivot</span><span class="o">=</span><span class="s1">&#39;middle&#39;</span><span class="p">,</span><span class="n">length</span><span class="o">=</span><span class="n">mag</span><span class="p">)</span>

    <span class="n">xmin</span><span class="p">,</span><span class="n">xmax</span><span class="o">=</span><span class="n">ax</span><span class="o">.</span><span class="n">get_xlim3d</span><span class="p">()</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim3d</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">((</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">xmin</span><span class="p">)),</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span><span class="n">xmax</span><span class="p">)))</span>
    <span class="n">ymin</span><span class="p">,</span><span class="n">ymax</span><span class="o">=</span><span class="n">ax</span><span class="o">.</span><span class="n">get_ylim3d</span><span class="p">()</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim3d</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">((</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">ymin</span><span class="p">)),</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span><span class="n">ymax</span><span class="p">)))</span>
    <span class="n">zmin</span><span class="p">,</span><span class="n">zmax</span><span class="o">=</span><span class="n">ax</span><span class="o">.</span><span class="n">get_zlim3d</span><span class="p">()</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_zlim3d</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">((</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">zmin</span><span class="p">)),</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span><span class="n">zmax</span><span class="p">)))</span>

    <span class="k">return</span> <span class="n">fig</span></div>

<div class="viewcode-block" id="MagSpecies"><a class="viewcode-back" href="../../../source/diffpy.mpdf.html#diffpy.mpdf.magstructure.MagSpecies">[docs]</a><span class="k">class</span> <span class="nc">MagSpecies</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Store information for a single species of magnetic atom.</span>


<span class="sd">    This class takes a diffpy.Structure object and uses it to generate spins</span>
<span class="sd">    based on a set of propagation vectors and basis vectors. For more info</span>
<span class="sd">    about magnetic propagation vectors, visit e.g.</span>
<span class="sd">    http://andrewsteele.co.uk/physics/mmcalc/docs/magneticpropagationvector</span>

<span class="sd">    Args:</span>
<span class="sd">        struc (diffpy.Structure object): provides lattice parameters and unit</span>
<span class="sd">            cell of desired structure.</span>
<span class="sd">        label (string): label for this particular magnetic species. Should be</span>
<span class="sd">            different from the labels for any other magnetic species you make.</span>
<span class="sd">        magIdxs (python list): list of integers giving indices of magnetic</span>
<span class="sd">            atoms in the unit cell</span>
<span class="sd">        atoms (numpy array): list of atomic coordinates of all the magnetic</span>
<span class="sd">            atoms in the structure; e.g. generated by generateAtomsXYZ()</span>
<span class="sd">        spins (numpy array): triplets giving the spin vectors of all the</span>
<span class="sd">            atoms, in the same order as the atoms array provided as input.</span>
<span class="sd">        rmaxAtoms (float): maximum distance from the origin of atomic</span>
<span class="sd">            positions generated by the makeAtoms method.</span>
<span class="sd">        basisvecs (numpy array): nested three-vector(s) giving the basis</span>
<span class="sd">            vectors to generate the spins. e.g. np.array([[0, 0, 1]]). Any</span>
<span class="sd">            phase factor should be included directly with the basisvecs.</span>
<span class="sd">        kvecs (numpy array): nested three-vector(s) giving the propagation</span>
<span class="sd">            vectors for the magnetic structure in r.l.u.,</span>
<span class="sd">            e.g. np.array([[0.5, 0.5, 0.5]])</span>
<span class="sd">        gS (float): spin component of the Lande g-factor (g = gS+gL)</span>
<span class="sd">        gL (float): orbital component of the Lande g-factor</span>
<span class="sd">        ffparamkey (string): gives the appropriate key for getFFparams()</span>
<span class="sd">        ffqgrid (numpy array): grid of momentum transfer values used for</span>
<span class="sd">            calculating the magnetic form factor.</span>
<span class="sd">        ff (numpy array): magnetic form factor.</span>
<span class="sd">        useDiffpyStruc (boolean): True if atoms/spins to be generated from</span>
<span class="sd">            a diffpy structure object; False if a user-provided unit cell is</span>
<span class="sd">            to be used. Note that there may be some problems with user-</span>
<span class="sd">            provided unit cells with lattice angles strongly deviated from</span>
<span class="sd">            90 degrees.</span>
<span class="sd">        latVecs (numpy array): Provides the unit cell lattice vectors as</span>
<span class="sd">            np.array([avec, bvec, cvec]). Only useful if useDiffpyStruc = False.</span>
<span class="sd">        atomBasis (numpy array): Provides positions of the magnetic atoms</span>
<span class="sd">            in fractional coordinates within the unit cell. Only useful if</span>
<span class="sd">            useDiffpyStruc = False. Example: np.array([[0, 0, 0], [0.5, 0.5, 0.5]])</span>
<span class="sd">        spinBasis (numpy array): Provides the orientations of the spins in</span>
<span class="sd">            the unit cell, in the same order as atomBasis. Only useful if</span>
<span class="sd">            useDiffpyStruc = False. Example: np.array([[0, 0, 1], [0, 0, -1]])</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">struc</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">magIdxs</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">atoms</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">spins</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                 <span class="n">rmaxAtoms</span><span class="o">=</span><span class="mf">30.0</span><span class="p">,</span> <span class="n">basisvecs</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">kvecs</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">gS</span><span class="o">=</span><span class="mf">2.0</span><span class="p">,</span> <span class="n">gL</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span>
                 <span class="n">ffparamkey</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">ffqgrid</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">ff</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                 <span class="n">useDiffpyStruc</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">latVecs</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">atomBasis</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                 <span class="n">spinBasis</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label</span> <span class="o">=</span> <span class="n">label</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rmaxAtoms</span> <span class="o">=</span> <span class="n">rmaxAtoms</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">gS</span> <span class="o">=</span> <span class="n">gS</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">gL</span> <span class="o">=</span> <span class="n">gL</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ffparamkey</span> <span class="o">=</span> <span class="n">ffparamkey</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">useDiffpyStruc</span> <span class="o">=</span> <span class="n">useDiffpyStruc</span>
        <span class="k">if</span> <span class="n">magIdxs</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">magIdxs</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">magIdxs</span> <span class="o">=</span> <span class="n">magIdxs</span>
        <span class="k">if</span> <span class="n">struc</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">struc</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">struc</span> <span class="o">=</span> <span class="n">struc</span>
        <span class="k">if</span> <span class="n">atoms</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">atoms</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">atoms</span> <span class="o">=</span> <span class="n">atoms</span>
        <span class="k">if</span> <span class="n">spins</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">spins</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">spins</span> <span class="o">=</span> <span class="n">spins</span>
        <span class="k">if</span> <span class="n">basisvecs</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">basisvecs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">basisvecs</span> <span class="o">=</span> <span class="n">basisvecs</span>
        <span class="k">if</span> <span class="n">kvecs</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">kvecs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">kvecs</span> <span class="o">=</span> <span class="n">kvecs</span>
        <span class="k">if</span> <span class="n">ff</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ff</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ff</span> <span class="o">=</span> <span class="n">ff</span>
        <span class="k">if</span> <span class="n">ffqgrid</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ffqgrid</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">10.0</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ffqgrid</span> <span class="o">=</span> <span class="n">ffqgrid</span>
        <span class="k">if</span> <span class="n">latVecs</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">latVecs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">4.</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mf">4.</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">4.</span><span class="p">]])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ff</span> <span class="o">=</span> <span class="n">latVecs</span>
        <span class="k">if</span> <span class="n">atomBasis</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">atomBasis</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">atomBasis</span> <span class="o">=</span> <span class="n">atomBasis</span>
        <span class="k">if</span> <span class="n">spinBasis</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">spinBasis</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">spinBasis</span> <span class="o">=</span> <span class="n">spinBasis</span>

    <span class="k">def</span> <span class="nf">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">label</span> <span class="o">==</span> <span class="s1">&#39;&#39;</span><span class="p">:</span>
            <span class="k">return</span> <span class="s1">&#39;MagSpecies() object&#39;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">label</span><span class="o">+</span><span class="s1">&#39;: MagSpecies() object&#39;</span>

<div class="viewcode-block" id="MagSpecies.makeAtoms"><a class="viewcode-back" href="../../../source/diffpy.mpdf.html#diffpy.mpdf.magstructure.MagSpecies.makeAtoms">[docs]</a>    <span class="k">def</span> <span class="nf">makeAtoms</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Generate the Cartesian coordinates of the atoms for this species.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">useDiffpyStruc</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">atoms</span> <span class="o">=</span> <span class="n">generateAtomsXYZ</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">struc</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">rmaxAtoms</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">magIdxs</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">atoms</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">spins</span> <span class="o">=</span> <span class="n">generateFromUnitCell</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">latVecs</span><span class="p">,</span>
                                                              <span class="bp">self</span><span class="o">.</span><span class="n">atomBasis</span><span class="p">,</span>
                                                              <span class="bp">self</span><span class="o">.</span><span class="n">spinBasis</span><span class="p">,</span>
                                                              <span class="bp">self</span><span class="o">.</span><span class="n">rmaxAtoms</span><span class="p">)</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="k">print</span> <span class="s1">&#39;Please check latVecs, atomBasis, and spinBasis.&#39;</span></div>

<div class="viewcode-block" id="MagSpecies.makeSpins"><a class="viewcode-back" href="../../../source/diffpy.mpdf.html#diffpy.mpdf.magstructure.MagSpecies.makeSpins">[docs]</a>    <span class="k">def</span> <span class="nf">makeSpins</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Generate the Cartesian coordinates of the spin vectors in the</span>
<span class="sd">               structure. Must provide propagation vector(s) and basis</span>
<span class="sd">               vector(s).</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">useDiffpyStruc</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">spins</span> <span class="o">=</span> <span class="n">generateSpinsXYZ</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">struc</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">atoms</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">kvecs</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">basisvecs</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">print</span> <span class="s1">&#39;Since you are not using a diffpy Structure object,&#39;</span>
            <span class="k">print</span> <span class="s1">&#39;the spins are generated from the makeAtoms() method.&#39;</span>
            <span class="k">print</span> <span class="s1">&#39;Please call that method if you have not already.&#39;</span></div>

<div class="viewcode-block" id="MagSpecies.makeFF"><a class="viewcode-back" href="../../../source/diffpy.mpdf.html#diffpy.mpdf.magstructure.MagSpecies.makeFF">[docs]</a>    <span class="k">def</span> <span class="nf">makeFF</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Generate the magnetic form factor.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">g</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gS</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">gL</span>
        <span class="k">if</span> <span class="n">getFFparams</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ffparamkey</span><span class="p">)</span> <span class="o">!=</span> <span class="p">[</span><span class="s1">&#39;none&#39;</span><span class="p">]:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ff</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gS</span><span class="o">/</span><span class="n">g</span> <span class="o">*</span> <span class="n">jCalc</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ffqgrid</span><span class="p">,</span> <span class="n">getFFparams</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ffparamkey</span><span class="p">))</span><span class="o">+</span>
                       <span class="bp">self</span><span class="o">.</span><span class="n">gL</span><span class="o">/</span><span class="n">g</span> <span class="o">*</span> <span class="n">jCalc</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ffqgrid</span><span class="p">,</span> <span class="n">getFFparams</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ffparamkey</span><span class="p">),</span> <span class="n">j2</span><span class="o">=</span><span class="bp">True</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">print</span> <span class="s1">&#39;Using generic magnetic form factor.&#39;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ff</span> <span class="o">=</span> <span class="n">jCalc</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ffqgrid</span><span class="p">)</span></div>

<div class="viewcode-block" id="MagSpecies.spinsFromAtoms"><a class="viewcode-back" href="../../../source/diffpy.mpdf.html#diffpy.mpdf.magstructure.MagSpecies.spinsFromAtoms">[docs]</a>    <span class="k">def</span> <span class="nf">spinsFromAtoms</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">positions</span><span class="p">,</span><span class="n">fractional</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span><span class="n">returnIdxs</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return the spin vectors corresponding to specified atomic</span>
<span class="sd">           positions.</span>

<span class="sd">        This method calls the diffpy.mpdf.spinsFromAtoms() method. </span>

<span class="sd">        Args:</span>
<span class="sd">            magstruc: MagSpecies or MagStructure object containing atoms and spins</span>
<span class="sd">            positions (list or array): atomic positions for which the</span>
<span class="sd">                corresponding spins should be returned.</span>
<span class="sd">            fractional (boolean): set as True if the atomic positions are in</span>
<span class="sd">                fractional coordinates of the crystallographic lattice</span>
<span class="sd">                vectors.</span>
<span class="sd">            returnIdxs (boolean): if True, the indices of the spins will also be</span>
<span class="sd">                returned.</span>
<span class="sd">        Returns:</span>
<span class="sd">            Array consisting of the spins corresponding to the atomic positions.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">spinsFromAtoms</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">positions</span><span class="p">,</span><span class="n">fractional</span><span class="p">,</span><span class="n">returnIdxs</span><span class="p">)</span></div>

<div class="viewcode-block" id="MagSpecies.atomsFromSpins"><a class="viewcode-back" href="../../../source/diffpy.mpdf.html#diffpy.mpdf.magstructure.MagSpecies.atomsFromSpins">[docs]</a>    <span class="k">def</span> <span class="nf">atomsFromSpins</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">spinvecs</span><span class="p">,</span><span class="n">fractional</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span><span class="n">returnIdxs</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return the atomic positions corresponding to specified spins.</span>

<span class="sd">        This method calls the diffpy.mpdf.atomsFromSpins() method. </span>

<span class="sd">        Args:</span>
<span class="sd">            magstruc: MagSpecies or MagStructure object containing atoms and spins</span>
<span class="sd">            spinvecs (list or array): spin vectors for which the</span>
<span class="sd">                corresponding atoms should be returned.</span>
<span class="sd">            fractional (boolean): set as True if the atomic positions are to be</span>
<span class="sd">                returned as fractional coordinates of the crystallographic lattice</span>
<span class="sd">                vectors.</span>
<span class="sd">            returnIdxs (boolean): if True, the indices of the atoms will also be</span>
<span class="sd">                returned.</span>

<span class="sd">        Returns:</span>
<span class="sd">            List of arrays of atoms corresponding to the spins.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">atomsFromSpins</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">spinvecs</span><span class="p">,</span><span class="n">fractional</span><span class="p">,</span><span class="n">returnIdxs</span><span class="p">)</span></div>

<div class="viewcode-block" id="MagSpecies.runChecks"><a class="viewcode-back" href="../../../source/diffpy.mpdf.html#diffpy.mpdf.magstructure.MagSpecies.runChecks">[docs]</a>    <span class="k">def</span> <span class="nf">runChecks</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Run some simple checks and raise a warning if a problem is found.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">print</span> <span class="s1">&#39;Running checks for &#39;</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">label</span><span class="o">+</span><span class="s1">&#39; MagSpecies object...</span><span class="se">\n</span><span class="s1">&#39;</span>

        <span class="n">flagCount</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">flag</span> <span class="o">=</span> <span class="bp">False</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">useDiffpyStruc</span><span class="p">:</span>
            <span class="c1"># check that basisvecs and kvecs have same shape</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">kvecs</span><span class="o">.</span><span class="n">shape</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">basisvecs</span><span class="o">.</span><span class="n">shape</span><span class="p">:</span>
                <span class="n">flag</span> <span class="o">=</span> <span class="bp">True</span>
            <span class="k">if</span> <span class="n">flag</span><span class="p">:</span>
                <span class="n">flagCount</span> <span class="o">+=</span> <span class="mi">1</span>
                <span class="k">print</span> <span class="s1">&#39;kvecs and basisvecs must have the same dimensions.&#39;</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># check for improperlatVecs array</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">latVecs</span><span class="o">.</span><span class="n">shape</span> <span class="o">!=</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">):</span>
                <span class="n">flag</span> <span class="o">=</span> <span class="bp">True</span>
            <span class="k">if</span> <span class="n">flag</span><span class="p">:</span>
                <span class="n">flagCount</span> <span class="o">+=</span> <span class="mi">1</span>
                <span class="k">print</span> <span class="s1">&#39;latVecs array does not have the correct dimensions.&#39;</span>
                <span class="k">print</span> <span class="s1">&#39;It must be a 3 x 3 nested array.&#39;</span>
                <span class="k">print</span> <span class="s1">&#39;Good example: np.array([[4, 0, 0], [0, 4, 0], [0, 0, 4]])&#39;</span>
            <span class="n">flag</span> <span class="o">=</span> <span class="bp">False</span>

            <span class="c1"># check for mismatched number of atoms and spins in basis</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">atomBasis</span><span class="o">.</span><span class="n">shape</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">spinBasis</span><span class="o">.</span><span class="n">shape</span><span class="p">:</span>
                <span class="n">flag</span> <span class="o">=</span> <span class="bp">True</span>
            <span class="k">if</span> <span class="n">flag</span><span class="p">:</span>
                <span class="n">flagCount</span> <span class="o">+=</span> <span class="mi">1</span>
                <span class="k">print</span> <span class="s1">&#39;atomBasis and spinBasis must have the same dimensions.&#39;</span>

        <span class="c1"># summarize results</span>
        <span class="k">if</span> <span class="n">flagCount</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">print</span> <span class="s1">&#39;All MagSpecies() checks passed. No obvious problems found.</span><span class="se">\n</span><span class="s1">&#39;</span></div>

<div class="viewcode-block" id="MagSpecies.copy"><a class="viewcode-back" href="../../../source/diffpy.mpdf.html#diffpy.mpdf.magstructure.MagSpecies.copy">[docs]</a>    <span class="k">def</span> <span class="nf">copy</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return a deep copy of the MagSpecies object.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></div></div>

<div class="viewcode-block" id="MagStructure"><a class="viewcode-back" href="../../../source/diffpy.mpdf.html#diffpy.mpdf.magstructure.MagStructure">[docs]</a><span class="k">class</span> <span class="nc">MagStructure</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Build on the diffpy.Structure class to include magnetic attributes.</span>

<span class="sd">    This class takes a diffpy.Structure object and packages additional info</span>
<span class="sd">    relating to magnetic structure, which can then be fed to an MPDFcalculator</span>
<span class="sd">    object.</span>

<span class="sd">    Args:</span>
<span class="sd">        struc (diffpy.Structure object): provides lattice parameters and unit</span>
<span class="sd">            cell of desired structure.</span>
<span class="sd">        species (python dictionary): dictionary of magnetic species in the</span>
<span class="sd">            structure. The values are MagSpecies objects.</span>
<span class="sd">        atoms (numpy array): list of atomic coordinates of all the magnetic</span>
<span class="sd">            atoms in the structure; e.g. generated by generateAtomsXYZ()</span>
<span class="sd">        spins (numpy array): triplets giving the spin vectors of all the</span>
<span class="sd">            atoms, in the same order as the atoms array provided as input.</span>
<span class="sd">        gfactors (numpy array): Lande g-factors of the magnetic moments</span>
<span class="sd">        rmaxAtoms (float): maximum distance from the origin of atomic</span>
<span class="sd">            positions generated by the makeAtoms method.</span>
<span class="sd">        ffqgrid (numpy array): grid of momentum transfer values used for</span>
<span class="sd">            calculating the magnetic form factor.</span>
<span class="sd">        ff (numpy array): magnetic form factor. Should be same shape as</span>
<span class="sd">            ffqgrid.</span>
<span class="sd">        label (string): Optional descriptive string for the MagStructure.</span>
<span class="sd">   &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">struc</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">species</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">atoms</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">spins</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                 <span class="n">gfactors</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">rmaxAtoms</span><span class="o">=</span><span class="mf">30.0</span><span class="p">,</span> <span class="n">ffqgrid</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">ff</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                 <span class="n">label</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">):</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">rmaxAtoms</span> <span class="o">=</span> <span class="n">rmaxAtoms</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label</span> <span class="o">=</span> <span class="n">label</span>

        <span class="k">if</span> <span class="n">struc</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">struc</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">struc</span> <span class="o">=</span> <span class="n">struc</span>
        <span class="k">if</span> <span class="n">atoms</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">atoms</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">atoms</span> <span class="o">=</span> <span class="n">atoms</span>
        <span class="k">if</span> <span class="n">spins</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">spins</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">spins</span> <span class="o">=</span> <span class="n">spins</span>
        <span class="k">if</span> <span class="n">gfactors</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">gfactors</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">2.0</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">gfactors</span> <span class="o">=</span> <span class="n">gfactors</span>
        <span class="k">if</span> <span class="n">species</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">species</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">species</span> <span class="o">=</span> <span class="n">species</span>
        <span class="k">if</span> <span class="n">ffqgrid</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ffqgrid</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">10.0</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ffqgrid</span> <span class="o">=</span> <span class="n">ffqgrid</span>
        <span class="k">if</span> <span class="n">ff</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ff</span> <span class="o">=</span> <span class="n">jCalc</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ffqgrid</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ff</span> <span class="o">=</span> <span class="n">ff</span>

    <span class="k">def</span> <span class="nf">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">label</span> <span class="o">==</span> <span class="s1">&#39;&#39;</span><span class="p">:</span>
            <span class="k">return</span> <span class="s1">&#39;MagStructure() object&#39;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">label</span><span class="o">+</span><span class="s1">&#39;: MagStructure() object&#39;</span>

<div class="viewcode-block" id="MagStructure.makeSpecies"><a class="viewcode-back" href="../../../source/diffpy.mpdf.html#diffpy.mpdf.magstructure.MagStructure.makeSpecies">[docs]</a>    <span class="k">def</span> <span class="nf">makeSpecies</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">label</span><span class="p">,</span> <span class="n">magIdxs</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">atoms</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">spins</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                    <span class="n">basisvecs</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">kvecs</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">gS</span><span class="o">=</span><span class="mf">2.0</span><span class="p">,</span> <span class="n">gL</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">ffparamkey</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                    <span class="n">ffqgrid</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">ff</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Create a MagSpecies object and add it to the species dictionary.</span>

<span class="sd">        Args:</span>
<span class="sd">            label (string): label for this particular magnetic species. Should be</span>
<span class="sd">                different from the labels for any other magnetic species you make.</span>
<span class="sd">            magIdxs (python list): list of integers giving indices of magnetic</span>
<span class="sd">                atoms in the unit cell</span>
<span class="sd">            atoms (numpy array): list of atomic coordinates of all the magnetic</span>
<span class="sd">                atoms in the structure; e.g. generated by generateAtomsXYZ()</span>
<span class="sd">            spins (numpy array): triplets giving the spin vectors of all the</span>
<span class="sd">                atoms, in the same order as the atoms array provided as input.</span>
<span class="sd">            basisvecs (numpy array): nested three-vector(s) giving the basis</span>
<span class="sd">                vectors to generate the spins. e.g. np.array([[0, 0, 1]]). Any</span>
<span class="sd">                phase factor should be included directly with the basisvecs.</span>
<span class="sd">            kvecs (numpy array): nested three-vector(s) giving the propagation</span>
<span class="sd">                vectors for the magnetic structure in r.l.u.,</span>
<span class="sd">                e.g. np.array([[0.5, 0.5, 0.5]])</span>
<span class="sd">            gS (float): spin component of the Lande g-factor (g = gS+gL)</span>
<span class="sd">            gL (float): orbital component of the Lande g-factor</span>
<span class="sd">            ffparamkey (string): gives the appropriate key for getFFparams()</span>
<span class="sd">            ffqgrid (numpy array): grid of momentum transfer values used for</span>
<span class="sd">                calculating the magnetic form factor.</span>
<span class="sd">            ff (numpy array): magnetic form factor.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># check that the label is not a duplicate with any other mag species.</span>
        <span class="n">duplicate</span> <span class="o">=</span> <span class="bp">False</span>
        <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">species</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">name</span> <span class="o">==</span> <span class="n">label</span><span class="p">:</span>
                <span class="n">duplicate</span> <span class="o">=</span> <span class="bp">True</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">duplicate</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">ffqgrid</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
                <span class="n">ffqgrid</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">10.0</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">species</span><span class="p">[</span><span class="n">label</span><span class="p">]</span> <span class="o">=</span> <span class="n">MagSpecies</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">struc</span><span class="p">,</span> <span class="n">label</span><span class="p">,</span> <span class="n">magIdxs</span><span class="p">,</span> <span class="n">atoms</span><span class="p">,</span> <span class="n">spins</span><span class="p">,</span>
                                             <span class="bp">self</span><span class="o">.</span><span class="n">rmaxAtoms</span><span class="p">,</span> <span class="n">basisvecs</span><span class="p">,</span> <span class="n">kvecs</span><span class="p">,</span> <span class="n">gS</span><span class="p">,</span> <span class="n">gL</span><span class="p">,</span> <span class="n">ffparamkey</span><span class="p">,</span> <span class="n">ffqgrid</span><span class="p">,</span> <span class="n">ff</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">runChecks</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">print</span> <span class="s1">&#39;This label has already been assigned to another species in&#39;</span>
            <span class="k">print</span> <span class="s1">&#39;the structure. Please choose a new label.&#39;</span></div>

<div class="viewcode-block" id="MagStructure.getCoordsFromSpecies"><a class="viewcode-back" href="../../../source/diffpy.mpdf.html#diffpy.mpdf.magstructure.MagStructure.getCoordsFromSpecies">[docs]</a>    <span class="k">def</span> <span class="nf">getCoordsFromSpecies</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Read in atomic positions and spins from magnetic species.</span>

<span class="sd">        This differs from makeSpins() and makeAtoms() because it simply loads</span>
<span class="sd">        the atoms and spins from the species without re-generating them from </span>
<span class="sd">        the structure.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">tempA</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]])</span>
        <span class="n">tempS</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]])</span>
        <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">species</span><span class="p">:</span>
            <span class="n">na</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">species</span><span class="p">[</span><span class="n">key</span><span class="p">]</span><span class="o">.</span><span class="n">atoms</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">ns</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">species</span><span class="p">[</span><span class="n">key</span><span class="p">]</span><span class="o">.</span><span class="n">atoms</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">na</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">na</span> <span class="o">==</span> <span class="n">ns</span><span class="p">):</span>            
                <span class="n">tempA</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">tempA</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">species</span><span class="p">[</span><span class="n">key</span><span class="p">]</span><span class="o">.</span><span class="n">atoms</span><span class="p">))</span>
                <span class="n">tempS</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">tempS</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">species</span><span class="p">[</span><span class="n">key</span><span class="p">]</span><span class="o">.</span><span class="n">spins</span><span class="p">))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">print</span> <span class="s1">&#39;Coordinates of atoms and spins for &#39;</span> <span class="o">+</span> <span class="n">key</span>
                <span class="k">print</span> <span class="s1">&#39;have not been loaded because they have not yet been&#39;</span>
                <span class="k">print</span> <span class="s1">&#39;generated and/or do not match in shape.&#39;</span>
        <span class="k">if</span> <span class="n">tempA</span><span class="o">.</span><span class="n">shape</span> <span class="o">!=</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">):</span>        
            <span class="bp">self</span><span class="o">.</span><span class="n">atoms</span> <span class="o">=</span> <span class="n">tempA</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">spins</span> <span class="o">=</span> <span class="n">tempS</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>
        <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">species</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">atoms</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">spins</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span></div>

<div class="viewcode-block" id="MagStructure.loadSpecies"><a class="viewcode-back" href="../../../source/diffpy.mpdf.html#diffpy.mpdf.magstructure.MagStructure.loadSpecies">[docs]</a>    <span class="k">def</span> <span class="nf">loadSpecies</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">magSpec</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Load in an already-existing MagSpecies object</span>

<span class="sd">        Args:</span>
<span class="sd">            magSpec (MagSpecies object): The magnetic species to be imported</span>
<span class="sd">                into the structure.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># check that the label is not a duplicate with any other mag species.</span>
        <span class="n">duplicate</span> <span class="o">=</span> <span class="bp">False</span>
        <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">species</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">name</span> <span class="o">==</span> <span class="n">magSpec</span><span class="o">.</span><span class="n">label</span><span class="p">:</span>
                <span class="n">duplicate</span> <span class="o">=</span> <span class="bp">True</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">duplicate</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">species</span><span class="p">[</span><span class="n">magSpec</span><span class="o">.</span><span class="n">label</span><span class="p">]</span> <span class="o">=</span> <span class="n">magSpec</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">struc</span> <span class="o">=</span> <span class="n">magSpec</span><span class="o">.</span><span class="n">struc</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">getCoordsFromSpecies</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">runChecks</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">print</span> <span class="s1">&#39;The label for this species has already been assigned to&#39;</span>
            <span class="k">print</span> <span class="s1">&#39;another species in the structure. Please choose a new label&#39;</span>
            <span class="k">print</span> <span class="s1">&#39;for this species.&#39;</span></div>

<div class="viewcode-block" id="MagStructure.removeSpecies"><a class="viewcode-back" href="../../../source/diffpy.mpdf.html#diffpy.mpdf.magstructure.MagStructure.removeSpecies">[docs]</a>    <span class="k">def</span> <span class="nf">removeSpecies</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">label</span><span class="p">,</span> <span class="n">update</span><span class="o">=</span><span class="bp">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Remove a magnetic species from the species dictionary.</span>

<span class="sd">        Args:</span>
<span class="sd">            label (string): key for the dictionary entry to be removed.</span>
<span class="sd">            update (boolean): if True, the MagStructure will update its atoms</span>
<span class="sd">                and spins with the removed species now excluded.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">species</span><span class="p">[</span><span class="n">label</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">update</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">getCoordsFromSpecies</span><span class="p">()</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="k">print</span> <span class="s1">&#39;Species cannot be deleted. Check that you are using the&#39;</span>
            <span class="k">print</span> <span class="s1">&#39;correct species label.&#39;</span></div>

<div class="viewcode-block" id="MagStructure.makeAtoms"><a class="viewcode-back" href="../../../source/diffpy.mpdf.html#diffpy.mpdf.magstructure.MagStructure.makeAtoms">[docs]</a>    <span class="k">def</span> <span class="nf">makeAtoms</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Generate the Cartesian coordinates of the atoms for this species.</span>

<span class="sd">        Args:</span>
<span class="sd">            fromUnitCell (boolean): True if atoms/spins to be generated from</span>
<span class="sd">                a unit cell provided by the user; False if the diffpy structure</span>
<span class="sd">                object is to be used.</span>
<span class="sd">            unitcell (numpy array): Provides the unit cell lattice vectors as</span>
<span class="sd">                np.array((avec, bvec, cvec)).</span>
<span class="sd">            atombasis (numpy array): Provides positions of the magnetic atoms</span>
<span class="sd">                in fractional coordinates within the unit cell.</span>
<span class="sd">            spin cell (numpy array): Provides the orientations of the spins in</span>
<span class="sd">                the unit cell, in the same order as atombasis</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">temp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]])</span>
        <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">species</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">species</span><span class="p">[</span><span class="n">key</span><span class="p">]</span><span class="o">.</span><span class="n">makeAtoms</span><span class="p">()</span>
            <span class="n">temp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">temp</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">species</span><span class="p">[</span><span class="n">key</span><span class="p">]</span><span class="o">.</span><span class="n">atoms</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">atoms</span> <span class="o">=</span> <span class="n">temp</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span></div>

<div class="viewcode-block" id="MagStructure.makeSpins"><a class="viewcode-back" href="../../../source/diffpy.mpdf.html#diffpy.mpdf.magstructure.MagStructure.makeSpins">[docs]</a>    <span class="k">def</span> <span class="nf">makeSpins</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Generate the Cartesian coordinates of the spin vectors in the</span>
<span class="sd">               structure. Calls the makeSpins() method for each MagSpecies in</span>
<span class="sd">               the species dictionary and concatenates them together.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">temp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]])</span>
        <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">species</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">species</span><span class="p">[</span><span class="n">key</span><span class="p">]</span><span class="o">.</span><span class="n">makeSpins</span><span class="p">()</span>
            <span class="n">temp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">temp</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">species</span><span class="p">[</span><span class="n">key</span><span class="p">]</span><span class="o">.</span><span class="n">spins</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">spins</span> <span class="o">=</span> <span class="n">temp</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span></div>

<div class="viewcode-block" id="MagStructure.makeGfactors"><a class="viewcode-back" href="../../../source/diffpy.mpdf.html#diffpy.mpdf.magstructure.MagStructure.makeGfactors">[docs]</a>    <span class="k">def</span> <span class="nf">makeGfactors</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Generate an array of Lande g-factors in the same order as the spins</span>
<span class="sd">                in the MagStructure.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">temp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">2.0</span><span class="p">])</span>
        <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">species</span><span class="p">:</span>
            <span class="n">temp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">temp</span><span class="p">,</span>
                                   <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">species</span><span class="p">[</span><span class="n">key</span><span class="p">]</span><span class="o">.</span><span class="n">gS</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">species</span><span class="p">[</span><span class="n">key</span><span class="p">]</span><span class="o">.</span><span class="n">gL</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">species</span><span class="p">[</span><span class="n">key</span><span class="p">]</span><span class="o">.</span><span class="n">spins</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">gfactors</span> <span class="o">=</span> <span class="n">temp</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span></div>

<div class="viewcode-block" id="MagStructure.makeFF"><a class="viewcode-back" href="../../../source/diffpy.mpdf.html#diffpy.mpdf.magstructure.MagStructure.makeFF">[docs]</a>    <span class="k">def</span> <span class="nf">makeFF</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Generate the properly weighted average magnetic form factor of all</span>
<span class="sd">                the magnetic species in the structure.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ffqgrid</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">species</span><span class="o">.</span><span class="n">values</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">ffqgrid</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ff</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ffqgrid</span><span class="p">)</span>
            <span class="n">totatoms</span> <span class="o">=</span> <span class="mf">0.0</span>
            <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">species</span><span class="p">:</span>
                <span class="n">totatoms</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">species</span><span class="p">[</span><span class="n">key</span><span class="p">]</span><span class="o">.</span><span class="n">atoms</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">species</span><span class="p">:</span>
                <span class="n">frac</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">species</span><span class="p">[</span><span class="n">key</span><span class="p">]</span><span class="o">.</span><span class="n">atoms</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">/</span><span class="n">totatoms</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">species</span><span class="p">[</span><span class="n">key</span><span class="p">]</span><span class="o">.</span><span class="n">makeFF</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">ff</span> <span class="o">+=</span> <span class="n">frac</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">species</span><span class="p">[</span><span class="n">key</span><span class="p">]</span><span class="o">.</span><span class="n">ff</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">species</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">ff</span> <span class="o">=</span> <span class="n">jCalc</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ffqgrid</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">print</span> <span class="s1">&#39;Check that all mag species have same q-grid.&#39;</span></div>

<div class="viewcode-block" id="MagStructure.makeAll"><a class="viewcode-back" href="../../../source/diffpy.mpdf.html#diffpy.mpdf.magstructure.MagStructure.makeAll">[docs]</a>    <span class="k">def</span> <span class="nf">makeAll</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Shortcut method to generate atoms, spins, g-factors, and form</span>
<span class="sd">                factor for the magnetic structure all in one go.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">makeAtoms</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">makeSpins</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">makeGfactors</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">makeFF</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">runChecks</span><span class="p">()</span></div>

<div class="viewcode-block" id="MagStructure.spinsFromAtoms"><a class="viewcode-back" href="../../../source/diffpy.mpdf.html#diffpy.mpdf.magstructure.MagStructure.spinsFromAtoms">[docs]</a>    <span class="k">def</span> <span class="nf">spinsFromAtoms</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">positions</span><span class="p">,</span><span class="n">fractional</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span><span class="n">returnIdxs</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return the spin vectors corresponding to specified atomic</span>
<span class="sd">           positions.</span>

<span class="sd">        This method calls the diffpy.mpdf.spinsFromAtoms() method. </span>

<span class="sd">        Args:</span>
<span class="sd">            magstruc: MagSpecies or MagStructure object containing atoms and spins</span>
<span class="sd">            positions (list or array): atomic positions for which the</span>
<span class="sd">                corresponding spins should be returned.</span>
<span class="sd">            fractional (boolean): set as True if the atomic positions are in</span>
<span class="sd">                fractional coordinates of the crystallographic lattice</span>
<span class="sd">                vectors.</span>
<span class="sd">            returnIdxs (boolean): if True, the indices of the spins will also be</span>
<span class="sd">                returned.</span>
<span class="sd">        Returns:</span>
<span class="sd">            Array consisting of the spins corresponding to the atomic positions.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">spinsFromAtoms</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">positions</span><span class="p">,</span><span class="n">fractional</span><span class="p">,</span><span class="n">returnIdxs</span><span class="p">)</span></div>

<div class="viewcode-block" id="MagStructure.atomsFromSpins"><a class="viewcode-back" href="../../../source/diffpy.mpdf.html#diffpy.mpdf.magstructure.MagStructure.atomsFromSpins">[docs]</a>    <span class="k">def</span> <span class="nf">atomsFromSpins</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">spinvecs</span><span class="p">,</span><span class="n">fractional</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span><span class="n">returnIdxs</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return the atomic positions corresponding to specified spins.</span>

<span class="sd">        This method calls the diffpy.mpdf.atomsFromSpins() method. </span>

<span class="sd">        Args:</span>
<span class="sd">            magstruc: MagSpecies or MagStructure object containing atoms and spins</span>
<span class="sd">            spinvecs (list or array): spin vectors for which the</span>
<span class="sd">                corresponding atoms should be returned.</span>
<span class="sd">            fractional (boolean): set as True if the atomic positions are to be</span>
<span class="sd">                returned as fractional coordinates of the crystallographic lattice</span>
<span class="sd">                vectors.</span>
<span class="sd">            returnIdxs (boolean): if True, the indices of the atoms will also be</span>
<span class="sd">                returned.</span>

<span class="sd">        Returns:</span>
<span class="sd">            List of arrays of atoms corresponding to the spins.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">atomsFromSpins</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">spinvecs</span><span class="p">,</span><span class="n">fractional</span><span class="p">,</span><span class="n">returnIdxs</span><span class="p">)</span></div>

<div class="viewcode-block" id="MagStructure.visualize"><a class="viewcode-back" href="../../../source/diffpy.mpdf.html#diffpy.mpdf.magstructure.MagStructure.visualize">[docs]</a>    <span class="k">def</span> <span class="nf">visualize</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">atoms</span><span class="p">,</span><span class="n">spins</span><span class="p">,</span><span class="n">showcrystalaxes</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span>
                  <span class="n">axesorigin</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">])):</span>
        <span class="sd">&quot;&quot;&quot;Generate a crude 3-d plot to visualize the selected spins.</span>

<span class="sd">        Args:</span>
<span class="sd">            atoms (numpy array): array of atomic positions of spins to be</span>
<span class="sd">                visualized.</span>
<span class="sd">            spins (numpy array): array of spin vectors in same order as atoms.</span>
<span class="sd">            showcrystalaxes (boolean): if True, will display the crystal axes</span>
<span class="sd">                determined from the first magnetic species in the MagStructure</span>
<span class="sd">            axesorigin (array): position at which the crystal axes should be</span>
<span class="sd">                displayed</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="kn">as</span> <span class="nn">plt</span>        
        <span class="kn">from</span> <span class="nn">mpl_toolkits.mplot3d</span> <span class="kn">import</span> <span class="n">axes3d</span>

        <span class="n">fig</span> <span class="o">=</span> <span class="n">visualizeSpins</span><span class="p">(</span><span class="n">atoms</span><span class="p">,</span><span class="n">spins</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">showcrystalaxes</span><span class="p">:</span>
            <span class="n">ax3d</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">mspec</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">species</span><span class="o">.</span><span class="n">items</span><span class="p">()[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>
                <span class="k">if</span> <span class="n">mspec</span><span class="o">.</span><span class="n">useDiffpyStruc</span><span class="p">:</span>
                    <span class="n">lat</span><span class="o">=</span><span class="n">mspec</span><span class="o">.</span><span class="n">struc</span><span class="o">.</span><span class="n">lattice</span>
                    <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span> <span class="o">=</span> <span class="n">lat</span><span class="o">.</span><span class="n">stdbase</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span> <span class="o">=</span> <span class="n">mspec</span><span class="o">.</span><span class="n">latVecs</span>
                <span class="n">xo</span><span class="p">,</span> <span class="n">yo</span><span class="p">,</span> <span class="n">zo</span> <span class="o">=</span> <span class="n">axesorigin</span>
                <span class="n">ax3d</span><span class="o">.</span><span class="n">quiver</span><span class="p">(</span><span class="n">xo</span><span class="p">,</span> <span class="n">yo</span><span class="p">,</span> <span class="n">zo</span><span class="p">,</span> <span class="n">a</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">a</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">a</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">pivot</span><span class="o">=</span><span class="s1">&#39;tail&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">)</span>
                <span class="n">ax3d</span><span class="o">.</span><span class="n">quiver</span><span class="p">(</span><span class="n">xo</span><span class="p">,</span> <span class="n">yo</span><span class="p">,</span> <span class="n">zo</span><span class="p">,</span> <span class="n">b</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">b</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">b</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">pivot</span><span class="o">=</span><span class="s1">&#39;tail&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;g&#39;</span><span class="p">)</span>
                <span class="n">ax3d</span><span class="o">.</span><span class="n">quiver</span><span class="p">(</span><span class="n">xo</span><span class="p">,</span> <span class="n">yo</span><span class="p">,</span> <span class="n">zo</span><span class="p">,</span> <span class="n">c</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">c</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">c</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">pivot</span><span class="o">=</span><span class="s1">&#39;tail&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">)</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="k">print</span> <span class="s1">&#39;Please make sure your magnetic structure contains a&#39;</span>
                <span class="k">print</span> <span class="s1">&#39;magnetic species with MagSpecies.struc set to a diffpy&#39;</span>
                <span class="k">print</span> <span class="s1">&#39;structure or MagSpecies.latVecs provided and&#39;</span>
                <span class="k">print</span> <span class="s1">&#39;MagSpecies.useDiffpyStruc set to False.&#39;</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span></div>

<div class="viewcode-block" id="MagStructure.runChecks"><a class="viewcode-back" href="../../../source/diffpy.mpdf.html#diffpy.mpdf.magstructure.MagStructure.runChecks">[docs]</a>    <span class="k">def</span> <span class="nf">runChecks</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Run some simple checks and raise a warning if a problem is found.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># do the MagSpecies checks</span>
        <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">species</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">species</span><span class="p">[</span><span class="n">key</span><span class="p">]</span><span class="o">.</span><span class="n">runChecks</span><span class="p">()</span>

        <span class="k">print</span> <span class="s1">&#39;Running checks for &#39;</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">label</span><span class="o">+</span><span class="s1">&#39; MagStructure object...</span><span class="se">\n</span><span class="s1">&#39;</span>

        <span class="n">flag</span> <span class="o">=</span> <span class="bp">False</span>
        <span class="n">flagCount</span> <span class="o">=</span> <span class="mi">0</span>

        <span class="c1"># check for duplication among magnetic species</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">species</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>        
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">species</span><span class="o">.</span><span class="n">values</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">useDiffpyStruc</span><span class="p">:</span>
                <span class="n">idxs</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">species</span><span class="p">:</span>
                    <span class="n">idxs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">species</span><span class="p">[</span><span class="n">key</span><span class="p">]</span><span class="o">.</span><span class="n">magIdxs</span><span class="p">)</span>
                <span class="n">idxs</span> <span class="o">=</span> <span class="p">[</span><span class="n">item</span> <span class="k">for</span> <span class="n">sublist</span> <span class="ow">in</span> <span class="n">idxs</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">sublist</span><span class="p">]</span> <span class="c1"># flatten the list</span>
                <span class="k">for</span> <span class="n">idx</span> <span class="ow">in</span> <span class="n">idxs</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">idxs</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="n">idx</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
                        <span class="n">flag</span> <span class="o">=</span> <span class="bp">True</span>
                <span class="k">if</span> <span class="n">flag</span><span class="p">:</span>
                    <span class="n">flagCount</span> <span class="o">+=</span> <span class="mi">1</span>
                    <span class="k">print</span> <span class="s1">&#39;Warning: Magnetic species may have overlapping atoms.&#39;</span>
                    <span class="k">print</span> <span class="s1">&#39;Check the magIdxs lists for your magnetic species.&#39;</span>

        <span class="c1"># summarize results</span>
        <span class="k">if</span> <span class="n">flagCount</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">print</span> <span class="s1">&#39;All MagStructure checks passed. No obvious problems found.&#39;</span></div>

<div class="viewcode-block" id="MagStructure.getSpeciesIdxs"><a class="viewcode-back" href="../../../source/diffpy.mpdf.html#diffpy.mpdf.magstructure.MagStructure.getSpeciesIdxs">[docs]</a>    <span class="k">def</span> <span class="nf">getSpeciesIdxs</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return a dictionary with the starting index in the atoms and spins</span>
<span class="sd">           arrays corresponding to each magnetic species.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">idxDict</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">startIdx</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">species</span><span class="p">:</span>
            <span class="n">idxDict</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">startIdx</span>
            <span class="n">startIdx</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">species</span><span class="p">[</span><span class="n">key</span><span class="p">]</span><span class="o">.</span><span class="n">atoms</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">print</span> <span class="n">idxDict</span>
        <span class="k">return</span> <span class="n">idxDict</span></div>


<div class="viewcode-block" id="MagStructure.copy"><a class="viewcode-back" href="../../../source/diffpy.mpdf.html#diffpy.mpdf.magstructure.MagStructure.copy">[docs]</a>    <span class="k">def</span> <span class="nf">copy</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return a deep copy of the MagStructure object.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></div></div>


</pre></div>

          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper"><div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../../../index.html">Documentation overview</a><ul>
  <li><a href="../../index.html">Module code</a><ul>
  </ul></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="../../../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2016, Benjamin Frandsen and Simon Billinge.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 1.4.1</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.7</a>
      
    </div>

    

    
  </body>
</html>